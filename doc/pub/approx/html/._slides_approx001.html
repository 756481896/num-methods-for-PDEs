<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Study guide: Approximation of functions">
<meta name="keywords" content="approximation of general vectors,Galerkin method,projection,approximation of functions,approximation by sines,collocation method (approximation),approximation collocation,Lagrange (interpolating) polynomial,sparse matrices,mass matrix,mass lumping,lumped mass matrix,finite element, definition,dof map,numerical integration Midpoint rule,numerical integration Trapezoidal rule,numerical integration Simpson's rule,Midpoint rule,Trapezoidal rule,Simpson's rule,Gauss-Legendre quadrature,simplex elements,simplices,faces,edges,isoparametric mapping,mapping of reference cells isoparametric mapping">

<title>Study guide: Approximation of functions</title>


<style type="text/css">
/* bloodish style */

body {
  font-family: Helvetica, Verdana, Arial, Sans-serif;
  color: #404040;
  background: #ffffff;
}
h1 { font-size: 1.8em;  color: #8A0808; }
h2 { font-size: 1.6em;  color: #8A0808; }
h3 { font-size: 1.4em;  color: #8A0808; }
h4 { color: #8A0808; }
a { color: #8A0808; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #bababa;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #f8f8f8;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Why finite elements? ', 1, None, '___sec0'),
              (' The dolphin and its flow ', 2, None, '___sec1'),
              (' Solving PDEs by the finite element method ',
               2,
               None,
               '___sec2'),
              (' We start with function approximation, then we treat PDEs ',
               2,
               None,
               '___sec3'),
              (' Approximation in vector spaces ', 1, None, '___sec4'),
              (' Approximation set-up ', 2, None, '___sec5'),
              (' How to determine the coefficients? ', 2, None, '___sec6'),
              (' Approximation of planar vectors; problem ',
               2,
               'fem:approx:vec:plane',
               'fem:approx:vec:plane'),
              (' Approximation of planar vectors; vector space terminology ',
               2,
               None,
               '___sec8'),
              (' The least squares method; principle ', 2, None, '___sec9'),
              (' The least squares method; calculations ',
               2,
               None,
               '___sec10'),
              (' The projection (or Galerkin) method ', 2, None, '___sec11'),
              (' Approximation of general vectors ',
               2,
               'fem:approx:vec:Np1dim',
               'fem:approx:vec:Np1dim'),
              (' The least squares method ', 2, None, '___sec13'),
              (' The projection (or Galerkin) method ', 2, None, '___sec14'),
              (' Approximation of functions ',
               1,
               'fem:approx:global',
               'fem:approx:global'),
              (' The least squares method can be extended from vectors to functions ',
               2,
               'fem:approx:LS',
               'fem:approx:LS'),
              (' The least squares method; details ', 2, None, '___sec17'),
              (' The projection (or Galerkin) method ', 2, None, '___sec18'),
              (' Example: linear approximation; problem ',
               2,
               'fem:approx:global:linear',
               'fem:approx:global:linear'),
              (' Example: linear approximation; solution ',
               2,
               None,
               '___sec20'),
              (' Example: linear approximation; plot ', 2, None, '___sec21'),
              (' Implementation of the least squares method; ideas ',
               2,
               'fem:approx:global:LS:code',
               'fem:approx:global:LS:code'),
              (' Implementation of the least squares method; symbolic code ',
               2,
               None,
               '___sec23'),
              (' Improved code if symbolic integration fails ',
               2,
               None,
               '___sec24'),
              (' Implementation of the least squares method; plotting ',
               2,
               None,
               '___sec25'),
              (' Implementation of the least squares method; application ',
               2,
               None,
               '___sec26'),
              (' Perfect approximation; parabola approximating parabola ',
               2,
               'fem:approx:global:exact',
               'fem:approx:global:exact'),
              (' Perfect approximation; the general result ',
               2,
               None,
               '___sec28'),
              (' Perfect approximation; proof of the general result ',
               2,
               None,
               '___sec29'),
              (' Finite-precision/numerical computations; question ',
               2,
               'fem:approx:global:illconditioning',
               'fem:approx:global:illconditioning'),
              (' Finite-precision/numerical computations; results ',
               2,
               None,
               '___sec31'),
              (' The ill-conditioning is due to almost linearly dependent basis functions for large $N$ ',
               2,
               None,
               '___sec32'),
              (' Ill-conditioning: general conclusions ',
               2,
               None,
               '___sec33'),
              (' Fourier series approximation; problem and code ',
               2,
               'fem:approx:global:Fourier',
               'fem:approx:global:Fourier'),
              (' Fourier series approximation; plot ', 2, None, '___sec35'),
              (' Fourier series approximation; improvements ',
               2,
               None,
               '___sec36'),
              (' Fourier series approximation; final results ',
               2,
               None,
               '___sec37'),
              (' Orthogonal basis functions ', 2, None, '___sec38'),
              (' Function for the least squares method with orthogonal basis functions ',
               2,
               None,
               '___sec39'),
              (' Function for the least squares method with orthogonal basis functions; symbolic and numerical integration ',
               2,
               None,
               '___sec40'),
              (' The collocation or interpolation method; ideas and math ',
               2,
               'fem:approx:global:interp',
               'fem:approx:global:interp'),
              (' The collocation or interpolation method; implementation ',
               2,
               None,
               '___sec42'),
              (' The collocation or interpolation method; approximating a parabola by linear functions ',
               2,
               None,
               '___sec43'),
              (' Lagrange polynomials; motivation and ideas ',
               2,
               'fem:approx:global:Lagrange',
               'fem:approx:global:Lagrange'),
              (' Lagrange polynomials; formula and code ',
               2,
               None,
               '___sec45'),
              (' Lagrange polynomials; successful example ',
               2,
               None,
               '___sec46'),
              (' Lagrange polynomials; a less successful example ',
               2,
               None,
               '___sec47'),
              (' Lagrange polynomials; oscillatory behavior ',
               2,
               None,
               '___sec48'),
              (' Lagrange polynomials; remedy for strong oscillations ',
               2,
               None,
               '___sec49'),
              (' Lagrange polynomials; recalculation with Chebyshev nodes ',
               2,
               None,
               '___sec50'),
              (' Lagrange polynomials; less oscillations with Chebyshev nodes ',
               2,
               None,
               '___sec51'),
              (' Finite element basis functions ',
               1,
               'fem:approx:fe',
               'fem:approx:fe'),
              (' The basis functions have so far been global: $\\baspsi_i(x) \\neq 0$ almost everywhere ',
               2,
               None,
               '___sec53'),
              (' In the finite element method we use basis functions with local support ',
               2,
               None,
               '___sec54'),
              (' The linear combination of hat functions is a piecewise linear function ',
               2,
               None,
               '___sec55'),
              (' Elements and nodes ',
               2,
               'fem:approx:fe:def:elements:nodes',
               'fem:approx:fe:def:elements:nodes'),
              (' Example on elements with two nodes (P1 elements) ',
               2,
               None,
               '___sec57'),
              (' Illustration of two basis functions on the mesh ',
               2,
               None,
               '___sec58'),
              (' Example on elements with three nodes (P2 elements) ',
               2,
               None,
               '___sec59'),
              (' Some corresponding basis functions (P2 elements) ',
               2,
               None,
               '___sec60'),
              (' Examples on elements with four nodes (P3 elements) ',
               2,
               None,
               '___sec61'),
              (' Some corresponding basis functions (P3 elements) ',
               2,
               None,
               '___sec62'),
              (' The numbering does not need to be regular from left to right ',
               2,
               None,
               '___sec63'),
              (' Interpretation of the coefficients $c_i$ ',
               2,
               None,
               '___sec64'),
              (' Properties of the basis functions ', 2, None, '___sec65'),
              (' How to construct quadratic $\\basphi_i$ (P2 elements) ',
               2,
               None,
               '___sec66'),
              (' Example on linear $\\basphi_i$ (P1 elements) ',
               2,
               None,
               '___sec67'),
              (' Example on cubic $\\basphi_i$ (P3 elements) ',
               2,
               None,
               '___sec68'),
              (' Calculating the linear system for $c_i$ ',
               1,
               'fem:approx:global:linearsystem',
               'fem:approx:global:linearsystem'),
              (' Computing a specific matrix entry (1) ',
               2,
               None,
               '___sec70'),
              (' Computing a specific matrix entry (2) ',
               2,
               None,
               '___sec71'),
              (' Calculating a general row in the matrix; figure ',
               2,
               None,
               '___sec72'),
              (' Calculating a general row in the matrix; details ',
               2,
               None,
               '___sec73'),
              (' Calculation of the right-hand side ', 2, None, '___sec74'),
              (' Specific example with two elements; linear system and solution ',
               2,
               None,
               '___sec75'),
              (' Specific example with two elements; plot ',
               2,
               None,
               '___sec76'),
              (' Specific example with four elements; plot ',
               2,
               None,
               '___sec77'),
              (' Specific example: what about P2 elements? ',
               2,
               None,
               '___sec78'),
              (' Assembly of elementwise computations ',
               1,
               'fem:approx:fe:elementwise',
               'fem:approx:fe:elementwise'),
              (' Split the integrals into elementwise integrals ',
               2,
               None,
               '___sec80'),
              (' The element matrix and local vs global node numbers ',
               2,
               None,
               '___sec81'),
              (' Illustration of the matrix assembly: regularly numbered P1 elements ',
               2,
               None,
               '___sec82'),
              (' Illustration of the matrix assembly: regularly numbered P3 elements ',
               2,
               None,
               '___sec83'),
              (' Illustration of the matrix assembly: irregularly numbered P1 elements ',
               2,
               None,
               '___sec84'),
              (' Assembly of the right-hand side ', 2, None, '___sec85'),
              (' Mapping to a reference element ',
               1,
               'fem:approx:fe:mapping',
               'fem:approx:fe:mapping'),
              (' We use affine mapping: linear stretch of $X\\in [-1,1]$ to $x\\in [x_L,x_R]$ ',
               2,
               None,
               '___sec87'),
              (' Integral transformation ', 2, None, '___sec88'),
              (' Advantages of the reference element ', 2, None, '___sec89'),
              (' Standardized basis functions for P1 elements ',
               2,
               None,
               '___sec90'),
              (' Standardized basis functions for P2 elements ',
               2,
               None,
               '___sec91'),
              (' How to find the polynomial expressions? ',
               2,
               None,
               '___sec92'),
              (' Integration over a reference element; element matrix ',
               2,
               'fem:approx:fe:intg:ref',
               'fem:approx:fe:intg:ref'),
              (' Integration over a reference element; element vector ',
               2,
               None,
               '___sec94'),
              (" Tedious calculations! Let's use symbolic software ",
               2,
               None,
               '___sec95'),
              (' Implementation ', 1, None, '___sec96'),
              (' Compute finite element basis functions in the reference element ',
               2,
               None,
               '___sec97'),
              (' Compute the element matrix ', 2, None, '___sec98'),
              (' Example on symbolic vs numeric element matrix ',
               2,
               None,
               '___sec99'),
              (' Compute the element vector ', 2, None, '___sec100'),
              (' Fallback on numerical integration if symbolic integration of $\\int f\\refphi_r dx$ fails ',
               2,
               None,
               '___sec101'),
              (' Linear system assembly and solution ', 2, None, '___sec102'),
              (' Linear system solution ', 2, None, '___sec103'),
              (' Example on computing symbolic approximations ',
               2,
               None,
               '___sec104'),
              (' Example on computing numerical approximations ',
               2,
               None,
               '___sec105'),
              (' The structure of the coefficient matrix ',
               2,
               'fem:approx:fe:A:structure',
               'fem:approx:fe:A:structure'),
              (' General result: the coefficient matrix is sparse ',
               2,
               None,
               '___sec107'),
              (' Exemplifying the sparsity for P2 elements ',
               2,
               None,
               '___sec108'),
              (' Matrix sparsity pattern for regular/random numbering of P1 elements ',
               2,
               None,
               '___sec109'),
              (' Matrix sparsity pattern for regular/random numbering of P3 elements ',
               2,
               None,
               '___sec110'),
              (' Sparse matrix storage and solution ',
               2,
               'fem:approx:fe:impl:sparse',
               'fem:approx:fe:impl:sparse'),
              (' Approximate $f\\sim x^9$ by various elements; code ',
               2,
               None,
               '___sec112'),
              (' Approximate $f\\sim x^9$ by various elements; plot ',
               2,
               None,
               '___sec113'),
              (' Comparison of finite element and finite difference approximation ',
               1,
               'fem:approx:fe:fd',
               'fem:approx:fe:fd'),
              (' Interpolation/collocation with finite elements ',
               2,
               None,
               '___sec115'),
              (' Galerkin/project and least squares vs collocation/interpolation or finite differences ',
               2,
               None,
               '___sec116'),
              (' Expressing the left-hand side in finite difference operator notation ',
               2,
               None,
               '___sec117'),
              (' Treating the right-hand side; Trapezoidal rule ',
               2,
               None,
               '___sec118'),
              (" Treating the right-hand side; Simpson's rule ",
               2,
               None,
               '___sec119'),
              (' Finite element approximation vs finite differences ',
               2,
               None,
               '___sec120'),
              (' Making finite elements behave as finite differences ',
               2,
               None,
               '___sec121'),
              (' Limitations of the nodes and element concepts ',
               1,
               'fem:approx:fe:limitations',
               'fem:approx:fe:limitations'),
              (' The generalized element concept has cells, vertices, nodes, and degrees of freedom ',
               2,
               'fem:approx:fe:element',
               'fem:approx:fe:element'),
              (' The concept of a finite element ', 2, None, '___sec124'),
              (' Basic data structures: `vertices`, `cells`, `dof_map` ',
               2,
               'fem:approx:fe:element:impl',
               'fem:approx:fe:element:impl'),
              (' Example: data structures for P2 elements ',
               2,
               None,
               '___sec126'),
              (' Example: P0 elements ', 2, None, '___sec127'),
              (' A program with the fundamental algorithmic steps ',
               2,
               None,
               '___sec128'),
              (' Approximating a parabola by P0 elements ',
               2,
               None,
               '___sec129'),
              (' Computing the error of the approximation; principles ',
               2,
               'fem:approx:fe:element:impl:error',
               'fem:approx:fe:element:impl:error'),
              (' Computing the error of the approximation; details ',
               2,
               None,
               '___sec131'),
              (' How does the error depend on $h$ and $d$? ',
               2,
               None,
               '___sec132'),
              (' Cubic Hermite polynomials; definition ',
               2,
               None,
               '___sec133'),
              (' Cubic Hermite polynomials; derivation ',
               2,
               None,
               '___sec134'),
              (' Cubic Hermite polynomials; result ', 2, None, '___sec135'),
              (' Numerical integration ', 1, None, '___sec136'),
              (' Common form of a numerical integration rule ',
               2,
               None,
               '___sec137'),
              (' The Midpoint rule ', 2, None, '___sec138'),
              (' Newton-Cotes rules apply the nodes ',
               2,
               'fem:approx:fe:numint1',
               'fem:approx:fe:numint1'),
              (' Gauss-Legendre rules apply optimized points ',
               2,
               None,
               '___sec140'),
              (' Approximation of functions in 2D ',
               1,
               'fem:approx:2D',
               'fem:approx:2D'),
              (' Quick overview of the 2D case ', 2, None, '___sec142'),
              (' 2D basis functions as tensor products of 1D functions ',
               2,
               'fem:approx:2D:global',
               'fem:approx:2D:global'),
              (' Tensor products ', 2, None, '___sec144'),
              (' Double or single index? ', 2, None, '___sec145'),
              (' Example on 2D (bilinear) basis functions; formulas ',
               2,
               None,
               '___sec146'),
              (' Example on 2D (bilinear) basis functions; plot ',
               2,
               None,
               '___sec147'),
              (' Implementation; principal changes to the 1D code ',
               2,
               'fem:approx:2D:global:code',
               'fem:approx:2D:global:code'),
              (' Implementation; 2D integration ', 2, None, '___sec149'),
              (' Implementation; 2D basis functions ', 2, None, '___sec150'),
              (' Implementation; application ', 2, None, '___sec151'),
              (' Implementation; trying a perfect expansion ',
               2,
               None,
               '___sec152'),
              (' Generalization to 3D ',
               2,
               'fem:approx:3D:global',
               'fem:approx:3D:global'),
              (' Finite elements in 2D and 3D ', 1, None, '___sec154'),
              (' Examples on cell types ', 2, None, '___sec155'),
              (' Rectangular domain with 2D P1 elements ',
               2,
               None,
               '___sec156'),
              (' Deformed geometry with 2D P1 elements ',
               2,
               None,
               '___sec157'),
              (' Rectangular domain with 2D Q1 elements ',
               2,
               None,
               '___sec158'),
              (' Basis functions over triangles in the physical domain ',
               2,
               None,
               '___sec159'),
              (' Basic features of 2D elements ', 2, None, '___sec160'),
              (' Linear mapping of reference element onto general triangular cell ',
               2,
               None,
               '___sec161'),
              (' $\\basphi_i$: pyramid shape, composed of planes ',
               2,
               None,
               '___sec162'),
              (' Element matrices and vectors ', 2, None, '___sec163'),
              (' Basis functions over triangles in the reference cell ',
               2,
               None,
               '___sec164'),
              (' 2D P1, P2, P3, P4, P5, and P6 elements ',
               2,
               None,
               '___sec165'),
              (' P1 elements in 1D, 2D, and 3D ', 2, None, '___sec166'),
              (' P2 elements in 1D, 2D, and 3D ', 2, None, '___sec167'),
              (' Affine mapping of the reference cell; formula ',
               2,
               None,
               '___sec168'),
              (' Affine mapping of the reference cell; figure ',
               2,
               None,
               '___sec169'),
              (' Isoparametric mapping of the reference cell ',
               2,
               None,
               '___sec170'),
              (' Computing integrals ', 2, None, '___sec171'),
              (' Remark on going from 1D to 2D/3D ', 2, None, '___sec172')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
$$




    
<a name="part0001"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._slides_approx000.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="&laquo; Previous"></a></div>
</td><td>
<div style="text-align: right;"><a href="._slides_approx002.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="Next &raquo;"></a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h2>Table of contents</h2>

<p>
<a href="._slides_approx002.html#___sec0"> Why finite elements? </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx003.html#___sec1"> The dolphin and its flow </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx004.html#___sec2"> Solving PDEs by the finite element method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx005.html#___sec3"> We start with function approximation, then we treat PDEs </a><br>
<a href="._slides_approx006.html#___sec4"> Approximation in vector spaces </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx007.html#___sec5"> Approximation set-up </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx008.html#___sec6"> How to determine the coefficients? </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx009.html#fem:approx:vec:plane"> Approximation of planar vectors; problem </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx010.html#___sec8"> Approximation of planar vectors; vector space terminology </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx011.html#___sec9"> The least squares method; principle </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx012.html#___sec10"> The least squares method; calculations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx013.html#___sec11"> The projection (or Galerkin) method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx014.html#fem:approx:vec:Np1dim"> Approximation of general vectors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx015.html#___sec13"> The least squares method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx016.html#___sec14"> The projection (or Galerkin) method </a><br>
<a href="._slides_approx017.html#fem:approx:global"> Approximation of functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx018.html#fem:approx:LS"> The least squares method can be extended from vectors to functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx019.html#___sec17"> The least squares method; details </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx020.html#___sec18"> The projection (or Galerkin) method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx021.html#fem:approx:global:linear"> Example: linear approximation; problem </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx022.html#___sec20"> Example: linear approximation; solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx023.html#___sec21"> Example: linear approximation; plot </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx024.html#fem:approx:global:LS:code"> Implementation of the least squares method; ideas </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx025.html#___sec23"> Implementation of the least squares method; symbolic code </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx026.html#___sec24"> Improved code if symbolic integration fails </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx027.html#___sec25"> Implementation of the least squares method; plotting </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx028.html#___sec26"> Implementation of the least squares method; application </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx029.html#fem:approx:global:exact"> Perfect approximation; parabola approximating parabola </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx030.html#___sec28"> Perfect approximation; the general result </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx031.html#___sec29"> Perfect approximation; proof of the general result </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx032.html#fem:approx:global:illconditioning"> Finite-precision/numerical computations; question </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx033.html#___sec31"> Finite-precision/numerical computations; results </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx034.html#___sec32"> The ill-conditioning is due to almost linearly dependent basis functions for large \( N \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx035.html#___sec33"> Ill-conditioning: general conclusions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx036.html#fem:approx:global:Fourier"> Fourier series approximation; problem and code </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx037.html#___sec35"> Fourier series approximation; plot </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx038.html#___sec36"> Fourier series approximation; improvements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx039.html#___sec37"> Fourier series approximation; final results </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx040.html#___sec38"> Orthogonal basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx041.html#___sec39"> Function for the least squares method with orthogonal basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx042.html#___sec40"> Function for the least squares method with orthogonal basis functions; symbolic and numerical integration </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx043.html#fem:approx:global:interp"> The collocation or interpolation method; ideas and math </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx044.html#___sec42"> The collocation or interpolation method; implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx045.html#___sec43"> The collocation or interpolation method; approximating a parabola by linear functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx046.html#fem:approx:global:Lagrange"> Lagrange polynomials; motivation and ideas </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx047.html#___sec45"> Lagrange polynomials; formula and code </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx048.html#___sec46"> Lagrange polynomials; successful example </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx049.html#___sec47"> Lagrange polynomials; a less successful example </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx050.html#___sec48"> Lagrange polynomials; oscillatory behavior </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx051.html#___sec49"> Lagrange polynomials; remedy for strong oscillations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx052.html#___sec50"> Lagrange polynomials; recalculation with Chebyshev nodes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx053.html#___sec51"> Lagrange polynomials; less oscillations with Chebyshev nodes </a><br>
<a href="._slides_approx054.html#fem:approx:fe"> Finite element basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx055.html#___sec53"> The basis functions have so far been global: \( \baspsi_i(x) \neq 0 \) almost everywhere </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx056.html#___sec54"> In the finite element method we use basis functions with local support </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx057.html#___sec55"> The linear combination of hat functions is a piecewise linear function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx058.html#fem:approx:fe:def:elements:nodes"> Elements and nodes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx059.html#___sec57"> Example on elements with two nodes (P1 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx060.html#___sec58"> Illustration of two basis functions on the mesh </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx061.html#___sec59"> Example on elements with three nodes (P2 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx062.html#___sec60"> Some corresponding basis functions (P2 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx063.html#___sec61"> Examples on elements with four nodes (P3 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx064.html#___sec62"> Some corresponding basis functions (P3 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx065.html#___sec63"> The numbering does not need to be regular from left to right </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx066.html#___sec64"> Interpretation of the coefficients \( c_i \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx067.html#___sec65"> Properties of the basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx068.html#___sec66"> How to construct quadratic \( \basphi_i \) (P2 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx069.html#___sec67"> Example on linear \( \basphi_i \) (P1 elements) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx070.html#___sec68"> Example on cubic \( \basphi_i \) (P3 elements) </a><br>
<a href="._slides_approx071.html#fem:approx:global:linearsystem"> Calculating the linear system for \( c_i \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx072.html#___sec70"> Computing a specific matrix entry (1) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx073.html#___sec71"> Computing a specific matrix entry (2) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx074.html#___sec72"> Calculating a general row in the matrix; figure </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx075.html#___sec73"> Calculating a general row in the matrix; details </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx076.html#___sec74"> Calculation of the right-hand side </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx077.html#___sec75"> Specific example with two elements; linear system and solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx078.html#___sec76"> Specific example with two elements; plot </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx079.html#___sec77"> Specific example with four elements; plot </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx080.html#___sec78"> Specific example: what about P2 elements? </a><br>
<a href="._slides_approx081.html#fem:approx:fe:elementwise"> Assembly of elementwise computations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx082.html#___sec80"> Split the integrals into elementwise integrals </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx083.html#___sec81"> The element matrix and local vs global node numbers </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx084.html#___sec82"> Illustration of the matrix assembly: regularly numbered P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx085.html#___sec83"> Illustration of the matrix assembly: regularly numbered P3 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx086.html#___sec84"> Illustration of the matrix assembly: irregularly numbered P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx087.html#___sec85"> Assembly of the right-hand side </a><br>
<a href="._slides_approx088.html#fem:approx:fe:mapping"> Mapping to a reference element </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx089.html#___sec87"> We use affine mapping: linear stretch of \( X\in [-1,1] \) to \( x\in [x_L,x_R] \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx090.html#___sec88"> Integral transformation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx091.html#___sec89"> Advantages of the reference element </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx092.html#___sec90"> Standardized basis functions for P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx093.html#___sec91"> Standardized basis functions for P2 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx094.html#___sec92"> How to find the polynomial expressions? </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx095.html#fem:approx:fe:intg:ref"> Integration over a reference element; element matrix </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx096.html#___sec94"> Integration over a reference element; element vector </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx097.html#___sec95"> Tedious calculations! Let's use symbolic software </a><br>
<a href="._slides_approx098.html#___sec96"> Implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx099.html#___sec97"> Compute finite element basis functions in the reference element </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx100.html#___sec98"> Compute the element matrix </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx101.html#___sec99"> Example on symbolic vs numeric element matrix </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx102.html#___sec100"> Compute the element vector </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx103.html#___sec101"> Fallback on numerical integration if symbolic integration of \( \int f\refphi_r dx \) fails </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx104.html#___sec102"> Linear system assembly and solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx105.html#___sec103"> Linear system solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx106.html#___sec104"> Example on computing symbolic approximations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx107.html#___sec105"> Example on computing numerical approximations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx108.html#fem:approx:fe:A:structure"> The structure of the coefficient matrix </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx109.html#___sec107"> General result: the coefficient matrix is sparse </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx110.html#___sec108"> Exemplifying the sparsity for P2 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx111.html#___sec109"> Matrix sparsity pattern for regular/random numbering of P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx112.html#___sec110"> Matrix sparsity pattern for regular/random numbering of P3 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx113.html#fem:approx:fe:impl:sparse"> Sparse matrix storage and solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx114.html#___sec112"> Approximate \( f\sim x^9 \) by various elements; code </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx115.html#___sec113"> Approximate \( f\sim x^9 \) by various elements; plot </a><br>
<a href="._slides_approx116.html#fem:approx:fe:fd"> Comparison of finite element and finite difference approximation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx117.html#___sec115"> Interpolation/collocation with finite elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx118.html#___sec116"> Galerkin/project and least squares vs collocation/interpolation or finite differences </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx119.html#___sec117"> Expressing the left-hand side in finite difference operator notation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx120.html#___sec118"> Treating the right-hand side; Trapezoidal rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx121.html#___sec119"> Treating the right-hand side; Simpson's rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx122.html#___sec120"> Finite element approximation vs finite differences </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx123.html#___sec121"> Making finite elements behave as finite differences </a><br>
<a href="._slides_approx124.html#fem:approx:fe:limitations"> Limitations of the nodes and element concepts </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx125.html#fem:approx:fe:element"> The generalized element concept has cells, vertices, nodes, and degrees of freedom </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx126.html#___sec124"> The concept of a finite element </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx127.html#fem:approx:fe:element:impl"> Basic data structures: <code>vertices</code>, <code>cells</code>, <code>dof_map</code> </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx128.html#___sec126"> Example: data structures for P2 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx129.html#___sec127"> Example: P0 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx130.html#___sec128"> A program with the fundamental algorithmic steps </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx131.html#___sec129"> Approximating a parabola by P0 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx132.html#fem:approx:fe:element:impl:error"> Computing the error of the approximation; principles </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx133.html#___sec131"> Computing the error of the approximation; details </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx134.html#___sec132"> How does the error depend on \( h \) and \( d \)? </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx135.html#___sec133"> Cubic Hermite polynomials; definition </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx136.html#___sec134"> Cubic Hermite polynomials; derivation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx137.html#___sec135"> Cubic Hermite polynomials; result </a><br>
<a href="._slides_approx138.html#___sec136"> Numerical integration </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx139.html#___sec137"> Common form of a numerical integration rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx140.html#___sec138"> The Midpoint rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx141.html#fem:approx:fe:numint1"> Newton-Cotes rules apply the nodes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx142.html#___sec140"> Gauss-Legendre rules apply optimized points </a><br>
<a href="._slides_approx143.html#fem:approx:2D"> Approximation of functions in 2D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx144.html#___sec142"> Quick overview of the 2D case </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx145.html#fem:approx:2D:global"> 2D basis functions as tensor products of 1D functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx146.html#___sec144"> Tensor products </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx147.html#___sec145"> Double or single index? </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx148.html#___sec146"> Example on 2D (bilinear) basis functions; formulas </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx149.html#___sec147"> Example on 2D (bilinear) basis functions; plot </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx150.html#fem:approx:2D:global:code"> Implementation; principal changes to the 1D code </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx151.html#___sec149"> Implementation; 2D integration </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx152.html#___sec150"> Implementation; 2D basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx153.html#___sec151"> Implementation; application </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx154.html#___sec152"> Implementation; trying a perfect expansion </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx155.html#fem:approx:3D:global"> Generalization to 3D </a><br>
<a href="._slides_approx156.html#___sec154"> Finite elements in 2D and 3D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx157.html#___sec155"> Examples on cell types </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx158.html#___sec156"> Rectangular domain with 2D P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx159.html#___sec157"> Deformed geometry with 2D P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx160.html#___sec158"> Rectangular domain with 2D Q1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx161.html#___sec159"> Basis functions over triangles in the physical domain </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx162.html#___sec160"> Basic features of 2D elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx163.html#___sec161"> Linear mapping of reference element onto general triangular cell </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx164.html#___sec162"> \( \basphi_i \): pyramid shape, composed of planes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx165.html#___sec163"> Element matrices and vectors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx166.html#___sec164"> Basis functions over triangles in the reference cell </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx167.html#___sec165"> 2D P1, P2, P3, P4, P5, and P6 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx168.html#___sec166"> P1 elements in 1D, 2D, and 3D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx169.html#___sec167"> P2 elements in 1D, 2D, and 3D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx170.html#___sec168"> Affine mapping of the reference cell; formula </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx171.html#___sec169"> Affine mapping of the reference cell; figure </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx172.html#___sec170"> Isoparametric mapping of the reference cell </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx173.html#___sec171"> Computing integrals </a><br>
&nbsp; &nbsp; &nbsp; <a href="._slides_approx174.html#___sec172"> Remark on going from 1D to 2D/3D </a><br>
</p>
<p>
<!-- 2DO: -->
<!-- Less 7= headings (or: ok when approx and varform are split?) -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._slides_approx000.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="&laquo; Previous"></a></div>
</td><td>
<div style="text-align: right;"><a href="._slides_approx002.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="Next &raquo;"></a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

