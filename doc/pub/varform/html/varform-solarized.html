<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Computing with variational forms">
<meta name="keywords" content="residual,variational formulation,trial function,test function,trial space,test space,integration by parts,weak form,strong form,natural boundary condition,essential boundary condition">

<title>Computing with variational forms</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Basic principles for approximating differential equations ',
               1,
               'fem:deq:1D:principles',
               'fem:deq:1D:principles'),
              (' Differential equation models ',
               2,
               'fem:deq:1D:models',
               'fem:deq:1D:models'),
              (' Simple model problems ',
               2,
               'fem:deq:1D:models:simple',
               'fem:deq:1D:models:simple'),
              (' Forming the residual ',
               2,
               'fem:deq:1D:residual:min',
               'fem:deq:1D:residual:min'),
              (' The least squares method ', 2, None, '___sec4'),
              (' The Galerkin method ', 2, None, '___sec5'),
              (' The Method of Weighted Residuals ', 2, None, '___sec6'),
              (' Test and Trial Functions ', 2, None, '___sec7'),
              (' The collocation method ', 2, None, '___sec8'),
              (' The subdomain collocation method ', 3, None, '___sec9'),
              (' Examples on using the principles ',
               2,
               'fem:deq:1D:ex:sines',
               'fem:deq:1D:ex:sines'),
              (' The model problem ', 3, None, '___sec11'),
              (' Basis functions ', 3, None, '___sec12'),
              (' The residual ', 3, None, '___sec13'),
              (' The least squares method ', 3, None, '___sec14'),
              (' The Galerkin method ', 3, None, '___sec15'),
              (' The collocation method ', 3, None, '___sec16'),
              (' Comparison ', 3, None, '___sec17'),
              (' Integration by parts ',
               2,
               'fem:deq:1D:varform',
               'fem:deq:1D:varform'),
              (' Weak form ', 3, None, '___sec19'),
              (' Boundary function ',
               2,
               'fem:deq:1D:essBC:Bfunc',
               'fem:deq:1D:essBC:Bfunc'),
              (' Abstract notation for variational formulations ',
               2,
               'fem:deq:1D:varform:abstract',
               'fem:deq:1D:varform:abstract'),
              (' Variational problems and optimization of functionals ',
               2,
               'fem:deq:1D:optimization',
               'fem:deq:1D:optimization'),
              (' Examples on variational formulations ',
               1,
               'fem:deq:1D:varform:ex',
               'fem:deq:1D:varform:ex'),
              (' Variable coefficient ', 2, None, '___sec24'),
              (' First-order derivative in the equation and boundary condition ',
               2,
               None,
               '___sec25'),
              (' Nonlinear coefficient ', 2, None, '___sec26'),
              (' Computing with Dirichlet and Neumann conditions ',
               2,
               'fem:deq:1D:varform:ex:DN:case',
               'fem:deq:1D:varform:ex:DN:case'),
              (' When the numerical method is exact ', 2, None, '___sec28'),
              (' Computing with finite elements ',
               1,
               'fem:deq:1D:fem1',
               'fem:deq:1D:fem1'),
              (' Finite element mesh and basis functions ',
               2,
               None,
               '___sec30'),
              (' Computation in the global physical domain ',
               2,
               'fem:deq:1D:comp:global',
               'fem:deq:1D:comp:global'),
              (' Comparison with a finite difference discretization ',
               2,
               None,
               '___sec32'),
              (' Cellwise computations ',
               2,
               'fem:deq:1D:comp:elmwise',
               'fem:deq:1D:comp:elmwise'),
              (' The integral for the element matrix ', 3, None, '___sec34'),
              (' The integral for the element vector ', 3, None, '___sec35'),
              (' Detailed calculations of the element matrix and vector ',
               3,
               None,
               '___sec36'),
              (' Contributions from the first and last cell ',
               3,
               None,
               '___sec37'),
              (' Assembly ', 3, None, '___sec38'),
              (' Boundary conditions: specified nonzero value ',
               1,
               'fem:deq:1D:essBC',
               'fem:deq:1D:essBC'),
              (' General construction of a boundary function ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc',
               'fem:deq:1D:fem:essBC:Bfunc'),
              (' Example on computing with finite element-based a boundary function ',
               2,
               None,
               '___sec41'),
              (' Computations in physical coordinates ', 3, None, '___sec42'),
              (' Cellwise computations on the reference element ',
               3,
               None,
               '___sec43'),
              (' Modification of the linear system ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys',
               'fem:deq:1D:fem:essBC:Bfunc:modsys'),
              (' Computations in the physical system ', 3, None, '___sec45'),
              (' Symmetric modification of the linear system ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm',
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm'),
              (' Modification of the element matrix and vector ',
               2,
               None,
               '___sec47'),
              (' Boundary conditions: specified derivative ',
               1,
               'fem:deq:1D:BC:nat',
               'fem:deq:1D:BC:nat'),
              (' The variational formulation ', 2, None, '___sec49'),
              (' Boundary term vanishes because of the test functions ',
               2,
               'fem:deq:1D:BC:nat:uLtest',
               'fem:deq:1D:BC:nat:uLtest'),
              (' Boundary term vanishes because of linear system modifications ',
               2,
               'fem:deq:1D:BC:nat:uLmod',
               'fem:deq:1D:BC:nat:uLmod'),
              (' Direct computation of the global linear system ',
               2,
               'fem:deq:1D:BC:nat:Aub',
               'fem:deq:1D:BC:nat:Aub'),
              (' Cellwise computations ', 2, None, '___sec53'),
              (' Implementation ',
               1,
               'fem:deq:1D:code:global',
               'fem:deq:1D:code:global'),
              (' Global basis functions ', 2, None, '___sec55'),
              (' Example: constant right-hand side ', 2, None, '___sec56'),
              (' Finite elements ', 2, None, '___sec57'),
              (' Variational formulations in 2D and 3D ',
               1,
               'fem:deq:2D:varform',
               'fem:deq:2D:varform'),
              (' Transformation to a reference cell in 2D and 3D ',
               2,
               None,
               '___sec59'),
              (' Numerical integration ', 2, None, '___sec60'),
              (' Convenient formulas for P1 elements in 2D ',
               2,
               None,
               '___sec61'),
              (' Summary ', 1, None, '___sec62'),
              (' Exercises ', 1, None, '___sec63'),
              (' Exercise 1: Refactor functions into a more general class ',
               2,
               'fem:deq:exer:BVP1D:class',
               'fem:deq:exer:BVP1D:class'),
              (' Exercise 2: Compute the deflection of a cable with sine functions ',
               2,
               'fem:deq:exer:tension:cable',
               'fem:deq:exer:tension:cable'),
              (' Exercise 3: Check integration by parts ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 4: Compute the deflection of a cable with 2 P1 elements ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 5: Compute the deflection of a cable with 1 P2 element ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 6: Compute the deflection of a cable with a step load ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 7: Show equivalence between linear systems ',
               2,
               'fem:deq:exer:Aub:essbc:equiv',
               'fem:deq:exer:Aub:essbc:equiv'),
              (' Exercise 8: Compute with a non-uniform mesh ',
               2,
               'fem:deq:exer:1D:mesh:nonuniform',
               'fem:deq:exer:1D:mesh:nonuniform'),
              (' Problem 9: Solve a 1D finite element problem by hand ',
               2,
               'fem:deq:exer:1D:gen:problem1',
               'fem:deq:exer:1D:gen:problem1'),
              (' Exercise 10: Compare finite elements and differences for a radially symmetric Poisson equation ',
               2,
               'fem:deq:exer:1D:Poisson:polar',
               'fem:deq:exer:1D:Poisson:polar'),
              (' Exercise 11: Compute with variable coefficients and P1 elements by hand ',
               2,
               'fem:deq:exer:1D:gen:problem2',
               'fem:deq:exer:1D:gen:problem2'),
              (' Exercise 12: Solve a 2D Poisson equation using polynomials and sines ',
               2,
               'fem:deq:exer:2D:torsion:xy:sin',
               'fem:deq:exer:2D:torsion:xy:sin'),
              (' Bibliography ', 1, None, '___sec76')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
$$




    
<a name="part0000"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
</td><td>
<div style="text-align: right;"><a href="._varform-solarized001.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- ------------------- main content ---------------------- -->



<center><h1>Computing with variational forms</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b>Department of Informatics, University of Oslo</b></center>
<p>
<center><h4>Apr 22, 2015</h4></center> <!-- date -->
<p>
<b>PRELIMINARY VERSION</b>

<h2>Table of contents</h2>

<p>
<a href="._varform-solarized002.html#fem:deq:1D:principles"> Basic principles for approximating differential equations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:models"> Differential equation models </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:models:simple"> Simple model problems </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:residual:min"> Forming the residual </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#___sec4"> The least squares method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#___sec5"> The Galerkin method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#___sec6"> The Method of Weighted Residuals </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#___sec7"> Test and Trial Functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#___sec8"> The collocation method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:ex:sines"> Examples on using the principles </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:varform"> Integration by parts </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:essBC:Bfunc"> Boundary function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:varform:abstract"> Abstract notation for variational formulations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized002.html#fem:deq:1D:optimization"> Variational problems and optimization of functionals </a><br>
<a href="._varform-solarized003.html#fem:deq:1D:varform:ex"> Examples on variational formulations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized003.html#___sec24"> Variable coefficient </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized003.html#___sec25"> First-order derivative in the equation and boundary condition </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized003.html#___sec26"> Nonlinear coefficient </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized003.html#fem:deq:1D:varform:ex:DN:case"> Computing with Dirichlet and Neumann conditions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized003.html#___sec28"> When the numerical method is exact </a><br>
<a href="._varform-solarized004.html#fem:deq:1D:fem1"> Computing with finite elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized004.html#___sec30"> Finite element mesh and basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized004.html#fem:deq:1D:comp:global"> Computation in the global physical domain </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized004.html#___sec32"> Comparison with a finite difference discretization </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized004.html#fem:deq:1D:comp:elmwise"> Cellwise computations </a><br>
<a href="._varform-solarized005.html#fem:deq:1D:essBC"> Boundary conditions: specified nonzero value </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized005.html#fem:deq:1D:fem:essBC:Bfunc"> General construction of a boundary function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized005.html#___sec41"> Example on computing with finite element-based a boundary function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized005.html#fem:deq:1D:fem:essBC:Bfunc:modsys"> Modification of the linear system </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized005.html#fem:deq:1D:fem:essBC:Bfunc:modsys:symm"> Symmetric modification of the linear system </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized005.html#___sec47"> Modification of the element matrix and vector </a><br>
<a href="._varform-solarized006.html#fem:deq:1D:BC:nat"> Boundary conditions: specified derivative </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized006.html#___sec49"> The variational formulation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized006.html#fem:deq:1D:BC:nat:uLtest"> Boundary term vanishes because of the test functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized006.html#fem:deq:1D:BC:nat:uLmod"> Boundary term vanishes because of linear system modifications </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized006.html#fem:deq:1D:BC:nat:Aub"> Direct computation of the global linear system </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized006.html#___sec53"> Cellwise computations </a><br>
<a href="._varform-solarized007.html#fem:deq:1D:code:global"> Implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized007.html#___sec55"> Global basis functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized007.html#___sec56"> Example: constant right-hand side </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized007.html#___sec57"> Finite elements </a><br>
<a href="._varform-solarized008.html#fem:deq:2D:varform"> Variational formulations in 2D and 3D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized008.html#___sec59"> Transformation to a reference cell in 2D and 3D </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized008.html#___sec60"> Numerical integration </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized008.html#___sec61"> Convenient formulas for P1 elements in 2D </a><br>
<a href="._varform-solarized009.html#___sec62"> Summary </a><br>
<a href="._varform-solarized010.html#___sec63"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:BVP1D:class"> Exercise 1: Refactor functions into a more general class </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:tension:cable"> Exercise 2: Compute the deflection of a cable with sine functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:intg:parts"> Exercise 3: Check integration by parts </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:intg:parts"> Exercise 4: Compute the deflection of a cable with 2 P1 elements </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:intg:parts"> Exercise 5: Compute the deflection of a cable with 1 P2 element </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:intg:parts"> Exercise 6: Compute the deflection of a cable with a step load </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:Aub:essbc:equiv"> Exercise 7: Show equivalence between linear systems </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:1D:mesh:nonuniform"> Exercise 8: Compute with a non-uniform mesh </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:1D:gen:problem1"> Problem 9: Solve a 1D finite element problem by hand </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:1D:Poisson:polar"> Exercise 10: Compare finite elements and differences for a radially symmetric Poisson equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:1D:gen:problem2"> Exercise 11: Compute with variable coefficients and P1 elements by hand </a><br>
&nbsp; &nbsp; &nbsp; <a href="._varform-solarized010.html#fem:deq:exer:2D:torsion:xy:sin"> Exercise 12: Solve a 2D Poisson equation using polynomials and sines </a><br>
<a href="._varform-solarized011.html#___sec76"> Bibliography </a><br>
</p>
<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
</td><td>
<div style="text-align: right;"><a href="._varform-solarized001.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

