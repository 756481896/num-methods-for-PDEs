<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Stationary variational forms">
<meta name="keywords" content="residual,weighted residuals,method of weighted residuals,variational formulation,weak formulation,trial function,test function,trial space,test space,integration by parts,weak form,strong form,natural boundary condition,essential boundary condition">

<title>Stationary variational forms</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Basic principles for approximating differential equations',
               1,
               'fem:deq:1D:principles',
               'fem:deq:1D:principles'),
              ('Differential equation models',
               2,
               'fem:deq:1D:models',
               'fem:deq:1D:models'),
              ('Simple model problems and their solutions',
               2,
               'fem:deq:1D:models:simple',
               'fem:deq:1D:models:simple'),
              ('Forming the residual',
               2,
               'fem:deq:1D:residual:min',
               'fem:deq:1D:residual:min'),
              ('The least squares method', 2, None, '___sec4'),
              ('The Galerkin method', 2, None, '___sec5'),
              ('The Method of Weighted Residuals', 2, None, '___sec6'),
              ('Test and Trial Functions', 2, None, '___sec7'),
              ('The collocation method', 2, None, '___sec8'),
              ('The subdomain collocation method', 3, None, '___sec9'),
              ('Examples on using the principles',
               2,
               'fem:deq:1D:ex:sines',
               'fem:deq:1D:ex:sines'),
              ('The model problem', 3, None, '___sec11'),
              ('Basis functions', 3, None, '___sec12'),
              ('The residual', 3, None, '___sec13'),
              ('The least squares method', 3, None, '___sec14'),
              ('The Galerkin method', 3, None, '___sec15'),
              ('The collocation method', 3, None, '___sec16'),
              ('Comparison', 3, None, '___sec17'),
              ('Integration by parts',
               2,
               'fem:deq:1D:varform',
               'fem:deq:1D:varform'),
              ('Weak form', 3, None, '___sec19'),
              ('Boundary function',
               2,
               'fem:deq:1D:essBC:Bfunc',
               'fem:deq:1D:essBC:Bfunc'),
              ('Abstract notation for variational formulations',
               2,
               'fem:deq:1D:varform:abstract',
               'fem:deq:1D:varform:abstract'),
              ('Variational problems and minimization of functionals',
               2,
               'fem:deq:1D:optimization',
               'fem:deq:1D:optimization'),
              ('Example', 3, None, '___sec23'),
              ('The general minimization problem', 3, None, '___sec24'),
              ('Derivation', 3, None, '___sec25'),
              ('Minimization of the discretized functional',
               3,
               None,
               '___sec26'),
              ('Calculus of variations', 3, None, '___sec27'),
              ('Examples on variational formulations',
               1,
               'fem:deq:1D:varform:ex',
               'fem:deq:1D:varform:ex'),
              ('Variable coefficient', 2, None, '___sec29'),
              ('First-order derivative in the equation and boundary condition',
               2,
               None,
               '___sec30'),
              ('Nonlinear coefficient', 2, None, '___sec31'),
              ('Computing with Dirichlet and Neumann conditions',
               2,
               'fem:deq:1D:varform:ex:DN:case',
               'fem:deq:1D:varform:ex:DN:case'),
              ('When the numerical method is exact', 2, None, '___sec33'),
              ('Computing with finite elements',
               1,
               'fem:deq:1D:fem1',
               'fem:deq:1D:fem1'),
              ('Finite element mesh and basis functions',
               2,
               None,
               '___sec35'),
              ('Computation in the global physical domain',
               2,
               'fem:deq:1D:comp:global',
               'fem:deq:1D:comp:global'),
              ('Comparison with a finite difference discretization',
               2,
               'fem:deq:1D:fdm_vs_fem',
               'fem:deq:1D:fdm_vs_fem'),
              ('Cellwise computations',
               2,
               'fem:deq:1D:comp:elmwise',
               'fem:deq:1D:comp:elmwise'),
              ('The integral for the element matrix', 3, None, '___sec39'),
              ('The integral for the element vector', 3, None, '___sec40'),
              ('Detailed calculations of the element matrix and vector',
               3,
               None,
               '___sec41'),
              ('Contributions from the first and last cell',
               3,
               None,
               '___sec42'),
              ('Assembly', 3, None, '___sec43'),
              ('Boundary conditions: specified nonzero value',
               1,
               'fem:deq:1D:essBC',
               'fem:deq:1D:essBC'),
              ('General construction of a boundary function',
               2,
               'fem:deq:1D:fem:essBC:Bfunc',
               'fem:deq:1D:fem:essBC:Bfunc'),
              ('Example on computing with a finite element-based boundary function',
               2,
               None,
               '___sec46'),
              ('Computations in physical coordinates', 3, None, '___sec47'),
              ('Cellwise computations on the reference element',
               3,
               None,
               '___sec48'),
              ('Modification of the linear system',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys',
               'fem:deq:1D:fem:essBC:Bfunc:modsys'),
              ('Computations in the physical system', 3, None, '___sec50'),
              ('Symmetric modification of the linear system',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm',
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm'),
              ('Modification of the element matrix and vector',
               2,
               None,
               '___sec52'),
              ('Boundary conditions: specified derivative',
               1,
               'fem:deq:1D:BC:nat',
               'fem:deq:1D:BC:nat'),
              ('The variational formulation', 2, None, '___sec54'),
              ('Boundary term vanishes because of the test functions',
               2,
               'fem:deq:1D:BC:nat:uLtest',
               'fem:deq:1D:BC:nat:uLtest'),
              ('Boundary term vanishes because of linear system modifications',
               2,
               'fem:deq:1D:BC:nat:uLmod',
               'fem:deq:1D:BC:nat:uLmod'),
              ('Direct computation of the global linear system',
               2,
               'fem:deq:1D:BC:nat:Aub',
               'fem:deq:1D:BC:nat:Aub'),
              ('Cellwise computations', 2, None, '___sec58'),
              ('Implementation', 1, 'fem:deq:1D:code', 'fem:deq:1D:code'),
              ('Global basis functions',
               2,
               'fem:deq:1D:code:global',
               'fem:deq:1D:code:global'),
              ('Example: constant right-hand side', 2, None, '___sec61'),
              ('Finite elements',
               2,
               'fem:deq:1D:code:fe',
               'fem:deq:1D:code:fe'),
              ('Utilizing a sparse matrix',
               2,
               'fem:deq:1D:code:fe_sparse',
               'fem:deq:1D:code:fe_sparse'),
              ('Example', 3, None, '___sec64'),
              ('Variational formulations in 2D and 3D',
               1,
               'fem:deq:2D:varform',
               'fem:deq:2D:varform'),
              ('Integration by parts', 2, None, '___sec66'),
              ('Example on a multi-dimensional variational problem',
               2,
               None,
               '___sec67'),
              ('Transformation to a reference cell in 2D and 3D',
               2,
               None,
               '___sec68'),
              ('Numerical integration', 2, None, '___sec69'),
              ('Convenient formulas for P1 elements in 2D',
               2,
               None,
               '___sec70'),
              ('A glimpse of the mathematical theory of the finite element method',
               2,
               None,
               '___sec71'),
              ('Abstract variational forms', 3, None, '___sec72'),
              ('Example on an abstract variational form and associated spaces',
               3,
               None,
               '___sec73'),
              ('Assumptions', 3, None, '___sec74'),
              ('Existence and uniqueness', 3, None, '___sec75'),
              ('Stability', 3, None, '___sec76'),
              ('Equivalent minimization problem', 3, None, '___sec77'),
              ('Best approximation principle', 3, None, '___sec78'),
              ('Best approximation property in the norm of the space',
               3,
               None,
               '___sec79'),
              ('Symmetric, positive definite coefficient matrix',
               3,
               None,
               '___sec80'),
              ('Equivalent matrix minimization problem', 3, None, '___sec81'),
              ('A priori error estimate for the derivative',
               3,
               None,
               '___sec82'),
              ('A priori error estimate for the solution',
               3,
               None,
               '___sec83'),
              ('Summary', 1, None, '___sec84'),
              ('Exercises', 1, None, '___sec85'),
              ('Exercise 1: Refactor functions into a more general class',
               2,
               'fem:deq:exer:BVP1D:class',
               'fem:deq:exer:BVP1D:class'),
              ('Exercise 2: Compute the deflection of a cable with sine functions',
               2,
               'fem:deq:exer:tension:cable',
               'fem:deq:exer:tension:cable'),
              ('Least squares method', 3, None, '___sec88'),
              ("Galerkin's method", 3, None, '___sec89'),
              ('Decay of coefficients', 3, None, '___sec90'),
              ('Error in one-term solution', 3, None, '___sec91'),
              ('Exercise 3: Compute the deflection of a cable with power functions',
               2,
               'fem:deq:exer:tension:cable_xn',
               'fem:deq:exer:tension:cable_xn'),
              ('Exercise 4: Check integration by parts',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              ('Exercise 5: Compute the deflection of a cable with 2 P1 elements',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              ('Method 1: Excluding the unknown at $x=0$',
               3,
               None,
               '___sec95'),
              ('Method 2: Modifying the linear system', 3, None, '___sec96'),
              ('Exercise 6: Compute the deflection of a cable with 1 P2 element',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              ('Method 1: Excluding the unknown at $x=0$',
               3,
               None,
               '___sec98'),
              ('Method 2: Modifying the linear system', 3, None, '___sec99'),
              ('Exercise 7: Compute the deflection of a cable with a step load',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              ('Exercise 8: Compute with a non-uniform mesh',
               2,
               'fem:deq:exer:1D:mesh:nonuniform',
               'fem:deq:exer:1D:mesh:nonuniform'),
              ('Problem 9: Solve a 1D finite element problem by hand',
               2,
               'fem:deq:exer:1D:gen:problem1',
               'fem:deq:exer:1D:gen:problem1'),
              ('Exercise 10: Investigate exact finite element solutions',
               2,
               'fem:deq:exer:1D:exact_numerics',
               'fem:deq:exer:1D:exact_numerics'),
              ('Plots for m=0', 3, None, '___sec104'),
              ('Plots for m=1', 3, None, '___sec105'),
              ('Plots for m=2', 3, None, '___sec106'),
              ('Plots for m=3', 3, None, '___sec107'),
              ('Plots for m=4', 3, None, '___sec108'),
              ('Exercise 11: Compare finite elements and differences for a radially symmetric Poisson equation',
               2,
               'fem:deq:exer:1D:Poisson:polar',
               'fem:deq:exer:1D:Poisson:polar'),
              ('Exercise 12: Compute with variable coefficients and P1 elements by hand',
               2,
               'fem:deq:exer:1D:gen:problem2',
               'fem:deq:exer:1D:gen:problem2'),
              ('Exercise 13: Solve a 2D Poisson equation using polynomials and sines',
               2,
               'fem:deq:exer:2D:torsion:xy:sin',
               'fem:deq:exer:2D:torsion:xy:sin'),
              ('Bibliography', 1, None, '___sec112')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}
\newcommand{\sequencej}[1]{\left\{ {#1}_j \right\}_{j\in\If}}
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="varform-sol.html">Stationary variational forms</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._varform-sol001.html#fem:deq:1D:principles" style="font-size: 80%;">Basic principles for approximating differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol002.html#fem:deq:1D:varform:ex" style="font-size: 80%;">Examples on variational formulations</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol003.html#fem:deq:1D:fem1" style="font-size: 80%;">Computing with finite elements</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol004.html#fem:deq:1D:essBC" style="font-size: 80%;">Boundary conditions: specified nonzero value</a></li>
     <!-- navigation toc: --> <li><a href="#fem:deq:1D:BC:nat" style="font-size: 80%;">Boundary conditions: specified derivative</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol006.html#fem:deq:1D:code" style="font-size: 80%;">Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol007.html#fem:deq:2D:varform" style="font-size: 80%;">Variational formulations in 2D and 3D</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol008.html#___sec84" style="font-size: 80%;">Summary</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol009.html#___sec85" style="font-size: 80%;">Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._varform-sol010.html#___sec112" style="font-size: 80%;">Bibliography</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0005"></a>
<!-- !split -->

<h1 id="fem:deq:1D:BC:nat">Boundary conditions: specified derivative</h1>

<p>
Suppose our model problem \( -u''(x)=f(x) \) features
the boundary conditions \( u'(0)=C \) and \( u(L)=D \).
As already indicated in the section <a href="._varform-sol002.html#fem:deq:1D:varform:ex">Examples on variational formulations</a>,
the former condition can be incorporated through the boundary term
that arises from integration by parts. The details of this method will now be
illustrated in the context of finite element basis functions.

<h2 id="___sec54">The variational formulation </h2>

<p>
Starting with the Galerkin method,

$$
\begin{equation*}
\int_0^L(u''(x)+f(x))\baspsi_i(x) \dx = 0,\quad i\in\If,
\end{equation*}
$$

integrating \( u''\baspsi_i \) by parts results in

$$
\begin{equation*}
\int_0^Lu'(x)'\baspsi_i'(x) \dx -(u'(L)\baspsi_i(L) - u'(0)\baspsi_i(0)) =
\int_0^L f(x)\baspsi_i(x) \dx, \quad i\in\If\tp
\end{equation*}
$$

<p>
The first boundary term, \( u'(L)\baspsi_i(L) \),
vanishes because \( u(L)=D \).
The second boundary
term, \( u'(0)\baspsi_i(0) \), can be used to implement the condition \( u'(0)=C \),
provided \( \baspsi_i(0)\neq 0 \) for some \( i \) (but with finite elements
we fortunately have \( \baspsi_0(0)=1 \)).
The variational form of the differential equation then becomes

$$
\begin{equation*} \int_0^Lu'(x)\basphi_i'(x) \dx + C\basphi_i(0) =
\int_0^L f(x)\basphi_i(x) \dx,\quad i\in\If\tp
\tag{73}
\end{equation*}
$$

<h2 id="fem:deq:1D:BC:nat:uLtest">Boundary term vanishes because of the test functions</h2>

<p>
At points where \( u \) is known we may require \( \baspsi_i \) to vanish.
Here, \( u(L)=D \) and then \( \baspsi_i(L)=0 \), \( i\in\If \). Obviously,
the boundary term \( u'(L)\baspsi_i(L) \) then vanishes.

<p>
The set of basis functions \( \sequencei{\baspsi} \) contains, in this
case, all the finite element basis functions on the mesh, except
the one that is 1 at \( x=L \). The basis function that is left out is
used in a boundary function \( B(x) \) instead.
With a left-to-right numbering,
\( \baspsi_i = \basphi_i \), \( i=0,\ldots,N_n-2 \), and \( B(x)=D\basphi_{N_n-1} \):

$$ u(x) = D\basphi_{N_n-1}(x) + \sum_{j=0}^{N=N_n-2} c_j\basphi_j(x)\tp$$

<p>
Inserting this expansion for \( u \) in the variational form
<a href="#mjx-eqn-73">(73)</a> leads to the linear system

$$
\begin{equation}
\sum_{j=0}^{N}\left(
\int_0^L \basphi_i'(x)\basphi_j'(x) \dx \right)c_j =
\int_0^L\left(f(x)\basphi_i(x) -D\basphi_{N_n-1}'(x)\basphi_i'(x)\right) \dx
 - C\basphi_i(0),
\tag{74}
\end{equation}
$$

for \( i=0,\ldots,N=N_n-2 \).

<h2 id="fem:deq:1D:BC:nat:uLmod">Boundary term vanishes because of linear system modifications</h2>

<p>
We may, as an alternative to the approach in the previous section, use
a basis \( \sequencei{\baspsi} \) which contains all the finite element
functions on the mesh: \( \baspsi_i=\basphi_i \), \( i=0,\ldots,N_n-1=N \).  In
this case, \( u'(L)\baspsi_i(L)=u'(L)\basphi_i(L)\neq 0 \) for the \( i \)
corresponding to the boundary node at \( x=L \) (where \( \basphi_i=1 \)).
The number of this node is \( i=N_n-1=N \) if a left-to-right numbering of
nodes is utilized.

<p>
However, even though \( u'(L)\basphi_{N_n-1}(L)\neq 0 \), we do not need to
compute this term.  For \( i < N_n-1 \) we realize that \( \basphi_i(L)=0 \).  The
only nonzero contribution to the right-hand side comes from \( i=N \)
(\( b_N \)). Without a boundary function we must implement the
condition \( u(L)=D \) by the equivalent statement \( c_N=D \) and modify the
linear system accordingly. This modification will erase the last
row and replace \( b_N \) by another value. Any attempt to compute
the boundary term \( u'(L)\basphi_{N_n-1}(L) \) and store it in \( b_N \) will be
lost. Therefore, we can safely forget about boundary terms
corresponding to Dirichlet boundary conditions also when we use
the methods from the section <a href="._varform-sol004.html#fem:deq:1D:fem:essBC:Bfunc:modsys">Modification of the linear system</a>
or the section <a href="._varform-sol004.html#fem:deq:1D:fem:essBC:Bfunc:modsys:symm">Symmetric modification of the linear system</a>.

<p>
The expansion for \( u \) reads

$$
\begin{equation*}
u(x) = \sum_{j\in\If} c_j\basphi_j(x)\tp
\end{equation*}
$$

Insertion in the variational form
<a href="#mjx-eqn-73">(73)</a> leads to
the linear system

$$
\begin{equation}
\sum_{j\in\If}\left(
\int_0^L \basphi_i'(x)\basphi_j'(x) \dx \right)c_j =
\int_0^L\left(f(x)\basphi_i(x)\right) \dx
 - C\basphi_i(0),\quad i\in\If
\tp
\tag{75}
\end{equation}
$$

After having computed the system, we replace the last row by
\( c_N=D \), either straightforwardly as in
the section <a href="._varform-sol004.html#fem:deq:1D:fem:essBC:Bfunc:modsys">Modification of the linear system</a> or in a symmetric
fashion as in the section <a href="._varform-sol004.html#fem:deq:1D:fem:essBC:Bfunc:modsys:symm">Symmetric modification of the linear system</a>.
These modifications can also be performed in the element matrix and
vector for the right-most cell.

<h2 id="fem:deq:1D:BC:nat:Aub">Direct computation of the global linear system</h2>

<p>
We now turn to actual computations with P1 finite elements.
The focus is on how the linear system and
the element matrices and vectors are modified by the
condition \( u'(0)=C \).

<p>
Consider first the approach where Dirichlet conditions are incorporated
by a \( B(x) \) function and the known degree of freedom
\( C_{N_n-1} \) is left out from the linear system
(see the section <a href="#fem:deq:1D:BC:nat:uLtest">Boundary term vanishes because of the test functions</a>).
The relevant formula for the linear
system is given by <a href="#mjx-eqn-74">(74)</a>.
There are three differences compared to the extensively
computed case where \( u(0)=0 \) in the sections <a href="._varform-sol003.html#fem:deq:1D:comp:global">Computation in the global physical domain</a> and <a href="._varform-sol003.html#fem:deq:1D:comp:elmwise">Cellwise computations</a>.
First, because we do not have a Dirichlet
condition at the left boundary, we need to extend the linear system
<a href="._varform-sol003.html#mjx-eqn-56">(56)</a> with an equation associated with the node
\( \xno{0}=0 \).
According to the section <a href="._varform-sol004.html#fem:deq:1D:fem:essBC:Bfunc:modsys">Modification of the linear system</a>, this
extension consists of including \( A_{0,0}=1/h \), \( A_{0,1}=-1/h \), and \( b_0=h \).
For \( i>0 \) we have \( A_{i,i}=2/h \), \( A_{i-1,i}=A_{i,i+1}=-1/h \).
Second, we need to include
the extra term
\( -C\basphi_i(0) \) on the right-hand side. Since all \( \basphi_i(0)=0 \)
for \( i=1,\ldots,N \), this term reduces to \( -C\basphi_0(0)=-C \) and
affects only the first equation (\( i=0 \)). We simply add \( -C \) to \( b_0 \)
such that \( b_0=h - C \).
Third, the boundary term \( -\int_0^L D\basphi_{N_n-1}(x)\basphi_i\dx \)
must be computed. Since \( i=0,\ldots,N=N_n-2 \), this integral can only
get a nonzero contribution with \( i=N_n-2 \) over the last cell.
The result becomes \( -Dh/6 \).
The resulting linear system can be summarized in the form

$$
\begin{equation}
\frac{1}{h}\left(
\begin{array}{ccccccccc}
1 & -1 & 0 &\cdots & \cdots & \cdots & \cdots & \cdots & 0 \\ 
-1 & 2 & -1 & \ddots &   & &  & &  \vdots \\ 
0 & -1 & 2 & -1 &
\ddots & &  &  & \vdots \\ 
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\ 
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\ 
\vdots & &  & 0 & -1 & 2 & -1 & \ddots & \vdots \\ 
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\ 
\vdots & & & &  &\ddots  & \ddots &\ddots  & -1 \\ 
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & -1 & 2
\end{array}
\right)
\left(
\begin{array}{c}
c_0 \\ 
\vdots\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
c_{N}
\end{array}
\right)
=
\left(
\begin{array}{c}
h - C \\ 
2h\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
2h - Dh/6
\end{array}
\right)\tp
\tag{76}
\end{equation}
$$

<p>
Next we consider the technique where we modify the linear system to
incorporate Dirichlet conditions
(see the section <a href="#fem:deq:1D:BC:nat:uLmod">Boundary term vanishes because of linear system modifications</a>). Now \( N=N_n-1 \).
The two differences from the
case above is that the \( -\int_0^LD\basphi_{N_n-1}\basphi_i\dx \) term is
left out of the right-hand side and an extra last row associated
with the node \( \xno{N_n-1}=L \) where the Dirichlet condition applies
is appended to the system.
This last row is anyway replaced by the condition \( c_N=D \) or this
condition can be incorporated in a symmetric fashion. Using the simplest,
former approach gives

$$
\begin{equation}
\frac{1}{h}\left(
\begin{array}{ccccccccc}
1 & -1 & 0 &\cdots & \cdots & \cdots & \cdots & \cdots & 0 \\ 
-1 & 2 & -1 & \ddots &   & &  & &  \vdots \\ 
0 & -1 & 2 & -1 &
\ddots & &  &  & \vdots \\ 
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\ 
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\ 
\vdots & &  & 0 & -1 & 2 & -1 & \ddots & \vdots \\ 
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\ 
\vdots & & & &  &\ddots  & -1 & 2  & -1 \\ 
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & 0 & h
\end{array}
\right)
\left(
\begin{array}{c}
c_0 \\ 
\vdots\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
c_{N}
\end{array}
\right)
=
\left(
\begin{array}{c}
h - C \\ 
2h\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
2h \\ 
D
\end{array}
\right)\tp
\tag{77}
\end{equation}
$$

<p>
<!-- Note: show equivalence between the two systems!!! -->

<h2 id="___sec58">Cellwise computations </h2>

<p>
Now we compute with one element at a time, working in the reference
coordinate system \( X\in [-1,1] \).
We need to see how the
\( u'(0)=C \) condition affects the element matrix and vector.
The extra term \( -C\basphi_i(0) \) in the variational formulation
only affects the element vector in the first cell.
On the reference cell, \( -C\basphi_i(0) \) is transformed to
\( -C\refphi_r(-1) \), where \( r \) counts local degrees of freedom.
We have \( \refphi_0(-1)=1 \) and \( \refphi_1(-1)=0 \) so
we are left with the contribution
\( -C\refphi_0(-1)=-C \) to \( \tilde b^{(0)}_0 \):

$$
\begin{equation}
\tilde A^{(0)} =
A = \frac{1}{h}\left(\begin{array}{rr}
1 & 1\\ 
-1 & 1
\end{array}\right),\quad
\tilde b^{(0)} = \left(\begin{array}{c}
h - C\\ 
h
\end{array}\right)\tp
\tag{78}
\end{equation}
$$

No other element matrices or vectors are affected by the \( -C\basphi_i(0) \)
boundary term.

<p>
There are two alternative ways of incorporating the Dirichlet condition.
Following the section <a href="#fem:deq:1D:BC:nat:uLtest">Boundary term vanishes because of the test functions</a>, we get
a \( 1\times 1 \) element matrix in the last cell and
an element vector with an extra term containing \( D \):

$$
\begin{equation}
\tilde A^{(e)} =\frac{1}{h}\left(\begin{array}{r}
1
\end{array}\right),\quad
\tilde b^{(e)} = h\left(\begin{array}{c}
1 - D/6
\end{array}\right),
\tag{79}
\end{equation}
$$

<p>
Alternatively, we include the degree of freedom at the node with
\( u \) specified. The element matrix and vector must then be modified
to constrain the \( \tilde c_1 = c_N \) value at local node \( r=1 \):

$$
\begin{equation}
\tilde A^{(N_e)} =
A = \frac{1}{h}\left(\begin{array}{rr}
1 & 1\\ 
0 & h
\end{array}\right),\quad
\tilde b^{(N_e)} = \left(\begin{array}{c}
h\\ 
D
\end{array}\right)\tp
\tag{80}
\end{equation}
$$

<p>
<!-- Assemble and show that it is correct -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._varform-sol004.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._varform-sol006.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

