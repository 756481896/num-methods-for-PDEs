

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Automating scientific experiments</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Scientific software engineering with a simple ODE model as example" href="index.html" />
    <link rel="next" title="Exercises" href="._main_softeng1006.html" />
    <link rel="prev" title="Classes for problem and solution method" href="._main_softeng1004.html" />
 
  
   <style type="text/css">
     div.admonition {
       background-color: whiteSmoke;
       border: 1px solid #bababa;
     }
   </style>
  </head>

  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._main_softeng1006.html" title="Exercises"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._main_softeng1004.html" title="Classes for problem and solution method"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Scientific software engineering with a simple ODE model as example</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="automating-scientific-experiments">
<span id="softeng1-experiments"></span><h1>Automating scientific experiments<a class="headerlink" href="#automating-scientific-experiments" title="Permalink to this headline">¶</a></h1>
<p>Empirical scientific investigations based on running computer programs
require careful design of the experiments and accurate reporting of results.
Although there is a strong tradition to do such investigations manually,
the extreme requirements to scientific accuracy make a program much
better suited to conduct the experiments. We shall in this section outline
how we can write such programs, often called <em>scripts</em>, for running other
programs and archiving the results.</p>
<div class="admonition-scientific-investigation admonition">
<p class="first admonition-title">Scientific investigation</p>
<p class="last">The purpose of the investigations is to explore the quality of numerical
solutions to an ordinary differential equation. More specifically, we
solve the initial-value problem</p>
</div>
<div class="math" id="equation-softeng1:experiments:model">
<span id="eq-softeng1-experiments-model"></span><span class="eqno">(1)</span>\[        u^\prime(t) = -au(t),\quad u(0)=I,\quad t\in (0,T],\]\[by the  \( \theta \) -rule:\]\[.. _Eq:softeng1:experiments:theta:\]</div>
<div class="math" id="equation-softeng1:experiments:theta">
<span class="eqno">(2)</span>\[        u^{n+1} = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}u^n,
        \quad u^0=I{\thinspace .}\]\[This scheme corresponds to well-known methods:  \( \theta=0 \)  gives the
Forward Euler (FE) scheme,  \( \theta=1 \)  gives the Backward Euler (BE) scheme,
and  \( \theta=\frac{1}{2} \)  gives the Crank-Nicolson
(CN) or midpoint/centered scheme.\]\[For chosen constants  \( I \) ,  \( a \) , and  \( T \) , we run the three schemes for various
values of  \( \Delta t \) , and present in a report the following results:\]\[1. visual comparison of the numerical and exact solution in a plot for
   each  \( \Delta t \)  and  \( \theta=0,1,\frac{1}{2} \) ,\]\[2. a table and a plot of the norm of the numerical error versus  \( \Delta t \) 
   for  \( \theta=0,1,\frac{1}{2} \) .\]\[The report will also document the mathematical details of the problem under
investigation.\]</div>
<div class="section" id="available-software">
<h2>Available software<a class="headerlink" href="#available-software" title="Permalink to this headline">¶</a></h2>
<p>Appropriate software for implementing <a href="#equation-softeng1:experiments:theta">(2)</a>
is available in a program <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/doconce_src/model.py">model.py</a>, which is run as</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; python model.py --I 1.5 --a 0.25 --T 6 --dt 1.25 0.75 0.5
</pre></div>
</div>
<p>The command-line input corresponds to setting <span class="math">\(I=1.5\)</span>, <span class="math">\(a=0.25\)</span>, <span class="math">\(T=6\)</span>,
and run three values of <span class="math">\(\Delta t\)</span>: 1.25, 0.75, ad 0.5.</p>
<p>The results of running this <tt class="docutils literal"><span class="pre">model.py</span></tt> command are text in the
terminal window and a set of plot files.
The plot files have names <tt class="docutils literal"><span class="pre">M_D.E</span></tt>, where <tt class="docutils literal"><span class="pre">M</span></tt> denotes the method
(<tt class="docutils literal"><span class="pre">FE</span></tt>, <tt class="docutils literal"><span class="pre">BE</span></tt>, <tt class="docutils literal"><span class="pre">CN</span></tt> for <span class="math">\(\theta=0,1,\frac{1}{2}\)</span>, respectively), <tt class="docutils literal"><span class="pre">D</span></tt>
the time step length (here <tt class="docutils literal"><span class="pre">1.25</span></tt>, <tt class="docutils literal"><span class="pre">0.75</span></tt>, or <tt class="docutils literal"><span class="pre">0.5</span></tt>), and <tt class="docutils literal"><span class="pre">E</span></tt>
is the plot file extension <tt class="docutils literal"><span class="pre">png</span></tt> or <tt class="docutils literal"><span class="pre">pdf</span></tt>.
The text output in the terminal window looks like</p>
<div class="highlight-text"><div class="highlight"><pre>0.0   1.25:    5.998E-01
0.0   0.75:    1.926E-01
0.0   0.50:    1.123E-01
0.0   0.10:    1.558E-02
0.5   1.25:    6.231E-02
0.5   0.75:    1.543E-02
0.5   0.50:    7.237E-03
0.5   0.10:    2.469E-04
1.0   1.25:    1.766E-01
1.0   0.75:    8.579E-02
1.0   0.50:    6.884E-02
1.0   0.10:    1.411E-02
</pre></div>
</div>
<p>The first column is the <span class="math">\(\theta\)</span> value, the next the <span class="math">\(\Delta t\)</span> value,
and the final column represents the numerical error <span class="math">\(E\)</span> (the
norm of discrete error function on the mesh).</p>
</div>
<div class="section" id="required-new-results">
<h2>Required new results<a class="headerlink" href="#required-new-results" title="Permalink to this headline">¶</a></h2>
<p>The results we need for our investigations are slightly different than
what is directly produced by <tt class="docutils literal"><span class="pre">model.py</span></tt>:</p>
<ol class="arabic simple">
<li>We need to collect all the plots for one
numerical method (FE, BE, CN) in a single plot.
For example, if 4 <span class="math">\(\Delta t\)</span> values are run, the summarizing plot
for the BE method has <span class="math">\(2\times 2\)</span> subplots, with the subplot corresponding
to the largest <span class="math">\(\Delta t\)</span> in the upper left corner and the smallest
in the bottom right corner.</li>
<li>We need to create a table containing
<span class="math">\(\Delta t\)</span> values in the first column and the numerical error
<span class="math">\(E\)</span> for <span class="math">\(\theta=0,0.5,1\)</span>
in the next three columns. This table should be available as a
standard CSV file.</li>
<li>We need to plot the numerical error <span class="math">\(E\)</span> versus <span class="math">\(\Delta t\)</span>
in a log-log plot.</li>
</ol>
<p>Consequently, we must write a script that can run <tt class="docutils literal"><span class="pre">model.py</span></tt> as described and
produce the results 1-3 above. This requires combining multiple plot files into
one file and interpreting the output from <tt class="docutils literal"><span class="pre">model.py</span></tt> as data for plotting and
file storage.</p>
<p>If the script&#8217;s name is <tt class="docutils literal"><span class="pre">exper1.py</span></tt>, we run it with the desired <span class="math">\(\Delta t\)</span>
values as positional command-line arguments:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; python exper1.py 0.5 0.25 0.1 0.05
</pre></div>
</div>
<p>This run will then generate eight plot files: <tt class="docutils literal"><span class="pre">FE.png</span></tt> and <tt class="docutils literal"><span class="pre">FE.pdf</span></tt> summarizing
the plots with the FE method, <tt class="docutils literal"><span class="pre">BE.png</span></tt> and <tt class="docutils literal"><span class="pre">BE.pdf</span></tt> with
the BE method, <tt class="docutils literal"><span class="pre">CN.png</span></tt> and <tt class="docutils literal"><span class="pre">CN.pdf</span></tt> with the CN method, and <tt class="docutils literal"><span class="pre">error.png</span></tt>
and <tt class="docutils literal"><span class="pre">error.pdf</span></tt> with the log-log plot of the numerical error versus <span class="math">\(\Delta t\)</span>.
In addition, the table with numerical errors is written to a
file <tt class="docutils literal"><span class="pre">error.csv</span></tt>.</p>
<div class="admonition-reproducible-science admonition">
<p class="first admonition-title">Reproducible science</p>
<p class="last">A script that automates running our computer experiments
will ensure
that the experiments can easily be rerun by anyone in
the future, either to confirm the results or redo the experiments with
other input data. Also, whatever we did to produce the results is
documented in every detail in the script.
Automating scripts are therefore essential to making our
research <em>reproducible</em>, which is a fundamental requirement in science.</p>
</div>
</div>
<div class="section" id="combining-plot-files">
<h2>Combining plot files<a class="headerlink" href="#combining-plot-files" title="Permalink to this headline">¶</a></h2>
<p>The script for running experiments needs to combine multiple image
files into one. The
<a class="reference external" href="http://www.imagemagick.org/script/montage.php">montage</a>
and
<a class="reference external" href="http://www.imagemagick.org/script/convert.php">convert</a> programs in
the ImageMagick software suite
can be used to combine image files.
However, these programs are best suited for
PNG files. For vector plots in PDF format one needs other tools
to preserve the quality: <tt class="docutils literal"><span class="pre">pdftk</span></tt>, <tt class="docutils literal"><span class="pre">pdfnup</span></tt>, and <tt class="docutils literal"><span class="pre">pdfcrop</span></tt>.</p>
<p>Suppose you have four files <tt class="docutils literal"><span class="pre">f1.png</span></tt>, <tt class="docutils literal"><span class="pre">f2.png</span></tt>, <tt class="docutils literal"><span class="pre">f3.png</span></tt>, and <tt class="docutils literal"><span class="pre">f4.png</span></tt>
and want to combine them into a <span class="math">\(2\times 2\)</span> table of subplots in a new
file <tt class="docutils literal"><span class="pre">f.png</span></tt>, see
Figure <a class="reference internal" href="#softeng1-experiments-fig-be4a"><em>Illustration of the Backward Euler method for four time step values</em></a> for an example.</p>
<div class="figure" id="softeng1-experiments-fig-be4a">
<a class="reference internal image-reference" href="_images/BE4a.png"><img alt="_images/BE4a.png" src="_images/BE4a.png" style="width: 600px;" /></a>
<p class="caption"><em>Illustration of the Backward Euler method for four time step values</em></p>
</div>
<p>The appropriate ImageMagick commands are</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; montage -background white -geometry 100% -tile 2x \
          f1.png f2.png f3.png f4.png f.png
Terminal&gt; convert -trim f.png f.png
Terminal&gt; convert f.png -transparent white f.png
</pre></div>
</div>
<p>The first command mounts the four files in one, the next <tt class="docutils literal"><span class="pre">convert</span></tt> command
removes unnecessary surrounding white space, and the final <tt class="docutils literal"><span class="pre">convert</span></tt> command
makes the white background transparent.</p>
<p>High-quality montage of PDF files <tt class="docutils literal"><span class="pre">f1.pdf</span></tt>,
<tt class="docutils literal"><span class="pre">f2.pdf</span></tt>, <tt class="docutils literal"><span class="pre">f3.pdf</span></tt>, and <tt class="docutils literal"><span class="pre">f4.pdf</span></tt> into <tt class="docutils literal"><span class="pre">f.pdf</span></tt> goes like</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; pdftk f1.pdf f2.pdf f3.pdf f4.pdf output tmp.pdf
Terminal&gt; pdfnup --nup 2x2 --outfile tmp.pdf tmp.pdf
Terminal&gt; pdfcrop tmp.pdf f.pdf
Terminal&gt; rm -f tmp.pdf
</pre></div>
</div>
</div>
<div class="section" id="running-a-program-from-python">
<h2>Running a program from Python<a class="headerlink" href="#running-a-program-from-python" title="Permalink to this headline">¶</a></h2>
<p>The script for automating experiments needs to run the <tt class="docutils literal"><span class="pre">model.py</span></tt> program
with appropriate command-line options. Python has several tools for
executing an arbitrary command in the operating systems.
Let <tt class="docutils literal"><span class="pre">cmd</span></tt> be a string containing the desired command.
In the present case study, <tt class="docutils literal"><span class="pre">cmd</span></tt> could be <tt class="docutils literal"><span class="pre">'python</span> <span class="pre">model.py</span> <span class="pre">--I</span> <span class="pre">1</span> <span class="pre">--dt</span> <span class="pre">0.5</span> <span class="pre">0.2'</span></tt>.
The following code
executes <tt class="docutils literal"><span class="pre">cmd</span></tt> and loads the text output into a string <tt class="docutils literal"><span class="pre">output</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span><span class="p">,</span> <span class="n">STDOUT</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">)</span>
<span class="n">output</span><span class="p">,</span> <span class="n">dummy</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>

<span class="c"># Check if the execution was successful</span>
<span class="n">failure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span>
<span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Command failed:&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Unsuccessful execution usually makes it meaningless to continue
the program, and therefore we abort the program with <tt class="docutils literal"><span class="pre">sys.exit(1)</span></tt>.
Any argument different from 0 signifies to the computer&#8217;s operating system
that our program stopped with a failure.</p>
<p>We need to interpret the contents of the string
<tt class="docutils literal"><span class="pre">output</span></tt> and store
the data in an appropriate data structure for further processing.
Since the content is basically a table and will be transformed to
a spread sheet format, we let the columns in the table be represented
by lists in the program,
and we collect these columns in a dictionary whose keys are natural
column names: <tt class="docutils literal"><span class="pre">dt</span></tt> and the three values of <span class="math">\(\theta\)</span>.
The following code translates the output of <tt class="docutils literal"><span class="pre">cmd</span></tt> (<tt class="docutils literal"><span class="pre">output</span></tt>)
to such a dictionary of lists (<tt class="docutils literal"><span class="pre">errors</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">errors</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;dt&#39;</span><span class="p">:</span> <span class="n">dt_values</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mf">0.5</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;0.5&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">):</span>  <span class="c"># line with E?</span>
        <span class="c"># typical line: 0.0   1.25:    7.463E+00</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">E</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">errors</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-automating-script">
<h2>The automating script<a class="headerlink" href="#the-automating-script" title="Permalink to this headline">¶</a></h2>
<p>We have now all the core elements in place to write the complete
script where we run
<tt class="docutils literal"><span class="pre">model.py</span></tt> for a set of <span class="math">\(\Delta t\)</span> values (given as positional
command-line arguments), make the error plot,
write the CSV file, and combine plot files as described above.
The complete code is listed below, followed by some explaining comments.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">run_experiments</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c"># The command line must contain dt values</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dt_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;Usage: </span><span class="si">%s</span><span class="s"> dt1 dt2 dt3 ...&#39;</span> <span class="o">%</span>  <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># abort</span>

    <span class="c"># Run module file and grab output</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s">&#39;python model.py --I </span><span class="si">%g</span><span class="s"> --a </span><span class="si">%g</span><span class="s"> --T </span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">dt_values_str</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dt_values</span><span class="p">])</span>
    <span class="n">cmd</span> <span class="o">+=</span> <span class="s">&#39; --dt </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dt_values_str</span>
    <span class="k">print</span> <span class="n">cmd</span>
    <span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span><span class="p">,</span> <span class="n">STDOUT</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">dummy</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="n">failure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span>
    <span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;Command failed:&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;dt&#39;</span><span class="p">:</span> <span class="n">dt_values</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mf">0.5</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="s">&#39;0.5&#39;</span><span class="p">,</span> <span class="s">&#39;1.0&#39;</span><span class="p">):</span>  <span class="c"># line with E?</span>
            <span class="c"># typical line: 0.0   1.25:    7.463E+00</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">E</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">errors</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

    <span class="c"># Find min/max for the axis</span>
    <span class="n">E_min</span> <span class="o">=</span> <span class="mf">1E+20</span><span class="p">;</span> <span class="n">E_max</span> <span class="o">=</span> <span class="o">-</span><span class="n">E_min</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">E_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">E_min</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">theta</span><span class="p">]))</span>
        <span class="n">E_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">E_max</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">theta</span><span class="p">]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s">&#39;dt&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;ro-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s">&#39;dt&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="s">&#39;b+-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="s">&#39;dt&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;gx-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&#39;FE&#39;</span><span class="p">,</span> <span class="s">&#39;CN&#39;</span><span class="p">,</span> <span class="s">&#39;BE&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;log(time step)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;log(error)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">dt_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">dt_values</span><span class="p">),</span> <span class="n">E_min</span><span class="p">,</span> <span class="n">E_max</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Error vs time step&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;error.png&#39;</span><span class="p">);</span>  <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;error.pdf&#39;</span><span class="p">)</span>

    <span class="c"># Write out a table in CSV format</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;error.csv&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">r&#39;$\Delta t$,$\theta=0$,$\theta=0.5$,$\theta=1$&#39;</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_dt</span><span class="p">,</span> <span class="n">_fe</span><span class="p">,</span> <span class="n">_cn</span><span class="p">,</span> <span class="n">_be</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">errors</span><span class="p">[</span><span class="s">&#39;dt&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%.2f</span><span class="s">,</span><span class="si">%.4f</span><span class="s">,</span><span class="si">%.4f</span><span class="s">,</span><span class="si">%.4f</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_dt</span><span class="p">,</span> <span class="n">_fe</span><span class="p">,</span> <span class="n">_cn</span><span class="p">,</span> <span class="n">_be</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># Combine images into rows with 2 plots in each row</span>
    <span class="n">image_commands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="s">&#39;BE&#39;</span><span class="p">,</span> <span class="s">&#39;CN&#39;</span><span class="p">,</span> <span class="s">&#39;FE&#39;</span><span class="p">:</span>
        <span class="n">pdf_files</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%g</span><span class="s">.pdf&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dt_values</span><span class="p">])</span>
        <span class="n">png_files</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%g</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dt_values</span><span class="p">])</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;montage -background white -geometry 100%&#39;</span> <span class="o">+</span>
            <span class="s">&#39; -tile 2x </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">png_files</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;convert -trim </span><span class="si">%s</span><span class="s">.png </span><span class="si">%s</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;convert </span><span class="si">%s</span><span class="s">.png -transparent white </span><span class="si">%s</span><span class="s">.png&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;pdftk </span><span class="si">%s</span><span class="s"> output tmp.pdf&#39;</span> <span class="o">%</span> <span class="n">pdf_files</span><span class="p">)</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dt_values</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;pdfnup --nup 2x</span><span class="si">%d</span><span class="s"> --outfile tmp.pdf tmp.pdf&#39;</span> <span class="o">%</span> <span class="n">num_rows</span><span class="p">)</span>
        <span class="n">image_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s">&#39;pdfcrop tmp.pdf </span><span class="si">%s</span><span class="s">.pdf&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">image_commands</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">cmd</span>
        <span class="n">failure</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Command failed:&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c"># Remove the files generated above and by model.py</span>
    <span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s">&#39;*_*.png&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">glob</span><span class="p">(</span><span class="s">&#39;*_*.pdf&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">glob</span><span class="p">(</span><span class="s">&#39;tmp*.pdf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">run_experiments</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><p id="index-2">We may comment upon many useful constructs in this script:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">[float(arg)</span> <span class="pre">for</span> <span class="pre">arg</span> <span class="pre">in</span> <span class="pre">sys.argv[1:]]</span></tt> builds a list of real numbers
from all the command-line arguments.</li>
<li><tt class="docutils literal"><span class="pre">['%s_%s.png'</span> <span class="pre">%</span> <span class="pre">(method,</span> <span class="pre">dt)</span> <span class="pre">for</span> <span class="pre">dt</span> <span class="pre">in</span> <span class="pre">dt_values]</span></tt> builds a list of
filenames from a list of numbers (<tt class="docutils literal"><span class="pre">dt_values</span></tt>).</li>
<li>All <tt class="docutils literal"><span class="pre">montage</span></tt>, <tt class="docutils literal"><span class="pre">convert</span></tt>, <tt class="docutils literal"><span class="pre">pdftk</span></tt>, <tt class="docutils literal"><span class="pre">pdfnup</span></tt>, and <tt class="docutils literal"><span class="pre">pdfcrop</span></tt>
commands for creating
composite figures are stored in a
list and later executed in a loop.</li>
<li><tt class="docutils literal"><span class="pre">glob('*_*.png')</span></tt> returns a list of the names of all files in the
current directory where the filename matches the <a class="reference external" href="http://en.wikipedia.org/wiki/Glob_(programming)">Unix wildcard notation</a>
<tt class="docutils literal"><span class="pre">*_*.png</span></tt> (meaning any text, underscore, any text, and then <tt class="docutils literal"><span class="pre">.png</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">os.remove(filename)</span></tt> removes the file with name <tt class="docutils literal"><span class="pre">filename</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">failure</span> <span class="pre">=</span> <span class="pre">os.system(cmd)</span></tt> runs an operating system command with
simpler syntax than what is required by <tt class="docutils literal"><span class="pre">subprocess</span></tt> (but the output
of <tt class="docutils literal"><span class="pre">cmd</span></tt> cannot be captured).</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="making-a-report">
<span id="softeng1-exper-report"></span><h2>Making a report<a class="headerlink" href="#making-a-report" title="Permalink to this headline">¶</a></h2>
<p>The results of running computer experiments are best documented in a
little report containing the problem to be solved, key code segments,
and the plots from a series of experiments. At least the part of the
report containing the plots should be automatically generated by the
script that performs the set of experiments, because in that script we
know exactly which input data that were used to generate a specific
plot, thereby ensuring that each figure is connected to the
right data. Take a look at <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/sphinx-cloud/">a sample report</a>  to see what we have in
mind.</p>
<span class="target" id="index-3"></span><span class="target" id="index-4"></span><div class="section" id="word-openoffice-googledocs">
<span id="index-5"></span><h3>Word, OpenOffice, GoogleDocs<a class="headerlink" href="#word-openoffice-googledocs" title="Permalink to this headline">¶</a></h3>
<p>Microsoft Word, its open source counterparts OpenOffice and
LibreOffice, along with GoogleDocs and similar online services are the
dominating tools for writing reports today. Nevertheless, scientific
reports often need mathematical equations and nicely typeset computer
code in monospace font. The support for mathematics and computer code
in the mentioned tools is in this author&#8217;s view not on par with the
technologies based on <em>markup languages</em> and which are addressed
below. Also, with markup languages one has a readable, pure text file
as source for the report, and changes in this text can easily be
tracked by version control systems like Git. The result is a very
strong tool for monitoring &#8220;who did what when&#8221; with the files,
resulting in increased reliability of the writing process. For
collaborative writing, the merge functionality in Git leads to safer
simultaneously editing that what is offered even by collaborative
tools like GoogleDocs.</p>
<span class="target" id="index-6"></span></div>
<div class="section" id="html-with-mathjax">
<span id="index-7"></span><h3>HTML with MathJax<a class="headerlink" href="#html-with-mathjax" title="Permalink to this headline">¶</a></h3>
<p>HTML is the markup language used for web pages.  Nicely typeset computer
code is straightforward in HTML, and high-quality mathematical
typesetting is available using an extension to HTML called <a class="reference external" href="http://www.mathjax.org/">MathJax</a>, which allows formulas and equations to be
typeset with LaTeX syntax and nicely rendered in web browsers, see
Figure <a class="reference internal" href="#softeng1-exper-report-fig-mathjax"><em>Report in HTML format with MathJax</em></a>.  A relatively small
subset of LaTeX environments for mathematics is supported, but the
syntax for formulas is quite rich. Inline formulas look like <tt class="docutils literal"><span class="pre">\(</span>
<span class="pre">u'=-au</span> <span class="pre">\)</span></tt> while equations are surrounded by <tt class="docutils literal"><span class="pre">$$</span></tt> signs.  Inside such
signs, one can use <tt class="docutils literal"><span class="pre">\[</span> <span class="pre">u'=-au</span> <span class="pre">\]</span></tt> for unnumbered equations, or
<tt class="docutils literal"><span class="pre">\begin{equation}</span></tt> and <tt class="docutils literal"><span class="pre">\end{equation}</span></tt> for
numbered equations, or <tt class="docutils literal"><span class="pre">\begin{equation}</span></tt> and <tt class="docutils literal"><span class="pre">\end{equation}</span></tt> for multiple
aligned equations.  You need to be familiar with <a class="reference external" href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">mathematical
typesetting in LaTeX</a> to write MathJax
code.</p>
<p>The file <a class="reference external" href="https://github.com/hplgit/hplgit.github.com/blob/master/teamods/writing_reports/report_generation/report_generation/exper1_html.py">exper1_mathjax.py</a>
calls a script
<a class="reference external" href="https://github.com/hplgit/hplgit.github.com/blob/master/teamods/writing_reports/report_generation/report_generation/exper1.py">exper1.py</a>
to perform the numerical experiments and then runs Python
statements for creating an <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report_mathjax.html.html">HTML file</a> with the source code for <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report_mathjax.html">the scientific report</a>.
The report contains a summary, a
section on the mathematical problem, a section on the numerical
method, a section on the <tt class="docutils literal"><span class="pre">solver</span></tt> function implementing the
method, and a section with subsections containing figures that show
the results of experiments where <span class="math">\(\Delta t\)</span> is varied for
<span class="math">\(\theta=0,0.5,1\)</span>.</p>
<div class="figure" id="softeng1-exper-report-fig-mathjax">
<a class="reference internal image-reference" href="_images/report_mathjax.png"><img alt="_images/report_mathjax.png" src="_images/report_mathjax.png" style="width: 600px;" /></a>
<p class="caption"><em>Report in HTML format with MathJax</em></p>
</div>
</div>
<div class="section" id="latex">
<span id="index-8"></span><h3>LaTeX<a class="headerlink" href="#latex" title="Permalink to this headline">¶</a></h3>
<p>The <em>de facto</em> language for mathematical typesetting and scientific
report writing is <a class="reference external" href="http://en.wikipedia.org/wiki/LaTeX">LaTeX</a>. A
number of very sophisticated packages have been added to the language
over a period of three decades, allowing very fine-tuned layout and
typesetting. For output in the <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report.pdf">PDF format</a>, see Figure
<a class="reference internal" href="#softeng1-exper-report-fig-latex"><em>Report in PDF format generated from LaTeX source</em></a> for an example, LaTeX is the
definite choice when it comes to <em>typesetting quality</em>.
The LaTeX language used to
write the reports has typically a lot of commands involving
<a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report.tex.html">backslashes and braces</a>, and many claim that
LaTeX syntax is not particularly readable.  For output on the web,
using HTML (and not the PDF directly in the browser window), LaTeX
struggles with delivering high quality typesetting. Other tools,
especially Sphinx, give better results and can also produce
nice-looking PDFs.  The file <a class="reference external" href="https://github.com/hplgit/hplgit.github.com/blob/master/teamods/writing_reports/report_generation/report_generation/exper1_latex.py">exper1_latex.py</a> shows how to
generate the LaTeX source from a program.</p>
<div class="figure" id="softeng1-exper-report-fig-latex">
<a class="reference internal image-reference" href="_images/report_latexpdf.png"><img alt="_images/report_latexpdf.png" src="_images/report_latexpdf.png" style="width: 600px;" /></a>
<p class="caption"><em>Report in PDF format generated from LaTeX source</em></p>
</div>
</div>
<div class="section" id="sphinx">
<span id="index-9"></span><h3>Sphinx<a class="headerlink" href="#sphinx" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> is a typesetting language with
similarities to HTML and LaTeX, but with much less tagging. It has
recently become very popular for software documentation and
mathematical reports. Sphinx can utilize LaTeX for mathematical
formulas and equations (via MathJax or PNG images). Unfortunately, the
subset of LaTeX mathematics supported is less than in full MathJax (in
particular, numbering of multiple equations in an <tt class="docutils literal"><span class="pre">align</span></tt> type
environment is not supported).  The <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report_sphinx.rst.html">Sphinx syntax</a> is an extension of
the reStructuredText language. An attractive feature of Sphinx is its
rich support for <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/sphinx-cloud/index.html">fancy layout of web pages</a>. In particular,
Sphinx can easily be combined with various layout <em>themes</em> that give a
certain look and feel to the web site and that offers table of
contents, navigation, and search facilities, see Figure
<a class="reference internal" href="#softeng1-exper-report-fig-sphinx"><em>Report in HTML format generated from Sphinx source</em></a>.</p>
<div class="figure" id="softeng1-exper-report-fig-sphinx">
<a class="reference internal image-reference" href="_images/report_sphinx.png"><img alt="_images/report_sphinx.png" src="_images/report_sphinx.png" style="width: 600px;" /></a>
<p class="caption"><em>Report in HTML format generated from Sphinx source</em></p>
</div>
</div>
<div class="section" id="markdown">
<span id="index-10"></span><h3>Markdown<a class="headerlink" href="#markdown" title="Permalink to this headline">¶</a></h3>
<p>A recent, very popular format for easy writing of web pages is
<a class="reference external" href="http://daringfireball.net/projects/markdown/">Markdown</a>.
Text is written very much like one would do in email, using
spacing and special characters to naturally format the code
instead of heavily tagging the text as in LaTeX and HTML.
With the tool <a class="reference external" href="http://johnmacfarlane.net/pandoc/">Pandoc</a> one
can go from Markdown to a variety of formats.
HTML is a common output format, but LaTeX, epub, XML,
OpenOffice/LibreOffice, MediaWiki, and Microsoft Word are some other
possibilities. A Markdown version of our scientific
report demo appears as an IPython/Jupyter notebook.</p>
<span class="target" id="index-11"></span></div>
<div class="section" id="ipython-jupyter-notebooks">
<span id="index-12"></span><h3>IPython/Jupyter notebooks<a class="headerlink" href="#ipython-jupyter-notebooks" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="http://ipython.org/notebook.html">IPython Notebook</a> is
a web-based tool where one can write scientific reports with live computer
code and graphics. Or the other way around: software can be equipped
with documentation in the style of scientific reports.
A slightly extended version of Markdown is used for writing text and
mathematics, and the <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report.ipynb.html">source code of a notebook</a> is in json format.
The notebook has
seen amazing growth in interest over just a few years and has now
involved into the <a class="reference external" href="https://jupyter.org/">Jupyter project</a> which
support a lot of programming languages for interactive notebook computing.
Jupyter notebooks are primarily live electronic documents, but they can be
printed out as PDF reports too.
A notebook version of our scientific report can be <a class="reference external" href="https://github.com/hplgit/hplgit.github.com/blob/master/teamods/writing_reports/report_generation/_static/report.ipynb">downloaded</a> and experimented with
or <a class="reference external" href="http://nbviewer.ipython.org/url/hplgit.github.com/teamods/writing_reports/_static/report.ipynb">just statically viewed</a> in a browser.</p>
</div>
<div class="section" id="wiki-formats">
<h3>Wiki formats<a class="headerlink" href="#wiki-formats" title="Permalink to this headline">¶</a></h3>
<p>A range of wiki formats are popular for creating notes on the web,
especially documents which allow groups of people to edit and add
content. Apart from <a class="reference external" href="http://www.mediawiki.org/wiki/MediaWiki">MediaWiki</a> (the wiki format used for
Wikipedia), wiki formats have no support for mathematical typesetting
and also limited tools for displaying computer code in nice ways.
Wiki formats are therefore less suitable for scientific reports compared
to the other formats mentioned here.</p>
</div>
<div class="section" id="doconce">
<span id="index-13"></span><h3>DocOnce<a class="headerlink" href="#doconce" title="Permalink to this headline">¶</a></h3>
<p>Since it is difficult to choose the right tool or format for writing a
scientific report, it is advantageous to write the content in a format
that easily translates to LaTeX, HTML, Sphinx, Markdown,
IPython/Jupyter notebooks, and various wikis. <a class="reference external" href="https://github.com/hplgit/doconce">DocOnce</a> is such a tool. It is similar to
Pandoc, but offers some special convenient features for writing about
mathematics and programming.  The <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report.do.txt.html">tagging is modest</a>, somewhere between
LaTeX and Markdown.  The program <a class="reference external" href="https://github.com/hplgit/hplgit.github.com/blob/master/teamods/writing_reports/report_generation/report_generation/exper1_do.py">exper1_do.py</a> demonstrates how
to generate DocOnce code for a scientific report.
There is also a corresponding rich demo of the <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/index.html">resulting reports</a> that can be made from
this DocOnce code.</p>
</div>
</div>
<div class="section" id="publishing-a-complete-project">
<span id="softeng1-exper-github"></span><h2>Publishing a complete project<a class="headerlink" href="#publishing-a-complete-project" title="Permalink to this headline">¶</a></h2>
<p>A report documenting scientific investigations should be accompanied by
all the software and data used for the investigations so that others
have a possibility to redo the work and assess the qualify of the results.
This possibility is important for <em>reproducible research</em> and
hence reaching reliable scientific conclusions.</p>
<p>One way of documenting a complete project is to make a directory tree
with all relevant files. Preferably, the tree is published at
some project hosting site like <a class="reference external" href="http://hplgit.github.com/teamods/bitgit/html/">Bitbucket or GitHub</a> so that others can download it
as a tarfile, zipfile, or clone the files directly using the Git version control
system.
For the investigations outlined in the section <a class="reference internal" href="#softeng1-exper-report"><em>Making a report</em></a>,
we can create a directory tree with files</p>
<div class="highlight-text"><div class="highlight"><pre>setup.py
./src:
   model.py
./doc:
   ./src:
      exper1_mathjax.py
      make_report.sh
      run.sh
   ./pub:
      report.html
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">src</span></tt> directory holds source code (modules) to be reused in other projects,
the <tt class="docutils literal"><span class="pre">setup.py</span></tt> builds and installs such software,
the <tt class="docutils literal"><span class="pre">doc</span></tt> directory contains the documentation, with <tt class="docutils literal"><span class="pre">src</span></tt> for the
source of the documentation and <tt class="docutils literal"><span class="pre">pub</span></tt> for ready-made, published documentation.
The <tt class="docutils literal"><span class="pre">run.sh</span></tt> file is a simple Bash script listing the <tt class="docutils literal"><span class="pre">python</span></tt> command
we used to run <tt class="docutils literal"><span class="pre">exper1_mathjax.py</span></tt> to generate the experiments and
the <tt class="docutils literal"><span class="pre">report.html</span></tt> file.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Automating scientific experiments</a><ul>
<li><a class="reference internal" href="#available-software">Available software</a></li>
<li><a class="reference internal" href="#required-new-results">Required new results</a></li>
<li><a class="reference internal" href="#combining-plot-files">Combining plot files</a></li>
<li><a class="reference internal" href="#running-a-program-from-python">Running a program from Python</a></li>
<li><a class="reference internal" href="#the-automating-script">The automating script</a></li>
<li><a class="reference internal" href="#making-a-report">Making a report</a><ul>
<li><a class="reference internal" href="#word-openoffice-googledocs">Word, OpenOffice, GoogleDocs</a></li>
<li><a class="reference internal" href="#html-with-mathjax">HTML with MathJax</a></li>
<li><a class="reference internal" href="#latex">LaTeX</a></li>
<li><a class="reference internal" href="#sphinx">Sphinx</a></li>
<li><a class="reference internal" href="#markdown">Markdown</a></li>
<li><a class="reference internal" href="#ipython-jupyter-notebooks">IPython/Jupyter notebooks</a></li>
<li><a class="reference internal" href="#wiki-formats">Wiki formats</a></li>
<li><a class="reference internal" href="#doconce">DocOnce</a></li>
</ul>
</li>
<li><a class="reference internal" href="#publishing-a-complete-project">Publishing a complete project</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._main_softeng1004.html"
                        title="previous chapter">Classes for problem and solution method</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._main_softeng1006.html"
                        title="next chapter">Exercises</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._main_softeng1005.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._main_softeng1006.html" title="Exercises"
             >next</a> |</li>
        <li class="right" >
          <a href="._main_softeng1004.html" title="Classes for problem and solution method"
             >previous</a> |</li>
        <li><a href="index.html">Scientific software engineering with a simple ODE model as example</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
  </div>
</div>

  </body>
</html>