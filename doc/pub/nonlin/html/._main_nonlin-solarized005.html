<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Nonlinear differential equation problems">
<meta name="keywords" content="linearization explicit time integration,linearization,Picard iteration,successive substitutions,fixed-point iteration,linearization Picard iteration,linearization successive substitutions,linearization fixed-point iteration,stopping criteria (nonlinear problems),single Picard iteration technique,relaxation (nonlinear equations),stopping criteria (nonlinear problems),group finite element method,product approximation technique,continuation method,online rendering of LaTeX formulas,continuation method">

<title>Nonlinear differential equation problems</title>


<link href="https://raw.githubusercontent.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Introduction of basic concepts ',
               1,
               'nonlin:timediscrete:logistic',
               'nonlin:timediscrete:logistic'),
              (' Linearization by explicit time discretization ',
               2,
               'nonlin:timediscrete:logistic:FE',
               'nonlin:timediscrete:logistic:FE'),
              (' Exact solution of nonlinear equations ',
               2,
               'nonlin:timediscrete:logistic:roots',
               'nonlin:timediscrete:logistic:roots'),
              (' Linearization ', 2, None, '___sec3'),
              (' Picard iteration ',
               2,
               'nonlin:timediscrete:logistic:Picard',
               'nonlin:timediscrete:logistic:Picard'),
              (' Stopping criteria ', 3, None, '___sec5'),
              (' A single Picard iteration ', 3, None, '___sec6'),
              (' Linearization by a geometric mean ',
               2,
               'nonlin:timediscrete:logistic:geometric:mean',
               'nonlin:timediscrete:logistic:geometric:mean'),
              (" Newton's method ",
               2,
               'nonlin:timediscrete:logistic:Newton',
               'nonlin:timediscrete:logistic:Newton'),
              (' Relaxation ',
               2,
               'nonlin:timediscrete:logistic:relaxation',
               'nonlin:timediscrete:logistic:relaxation'),
              (' Implementation and experiments ',
               2,
               'nonlin:timediscrete:logistic:impl',
               'nonlin:timediscrete:logistic:impl'),
              (' Generalization to a general nonlinear ODE ',
               2,
               'nonlin:ode:generic',
               'nonlin:ode:generic'),
              (' Explicit time discretization ', 3, None, '___sec12'),
              (' Backward Euler discretization ', 3, None, '___sec13'),
              (' Crank-Nicolson discretization ', 3, None, '___sec14'),
              (' Systems of nonlinear algebraic equations ',
               1,
               'nonlin:systems:alg',
               'nonlin:systems:alg'),
              (' Picard iteration ',
               2,
               'nonlin:systems:alg:Picard',
               'nonlin:systems:alg:Picard'),
              (" Newton's method ",
               2,
               'nonlin:systems:alg:Newton',
               'nonlin:systems:alg:Newton'),
              (' Stopping criteria ',
               2,
               'nonlin:systems:alg:terminate',
               'nonlin:systems:alg:terminate'),
              (' Example: A nonlinear ODE model from epidemiology ',
               2,
               'nonlin:systems:alg:SI',
               'nonlin:systems:alg:SI'),
              (' Implicit time discretization ', 3, None, '___sec20'),
              (' A Picard iteration ', 3, None, '___sec21'),
              (" Newton's method ", 3, None, '___sec22'),
              (' Linearization at the differential equation level ',
               1,
               'nonlin:pdelevel',
               'nonlin:pdelevel'),
              (' Explicit time integration ',
               2,
               'nonlin:pdelevel:explicit',
               'nonlin:pdelevel:explicit'),
              (' Backward Euler scheme and Picard iteration ',
               2,
               'nonlin:pdelevel:Picard',
               'nonlin:pdelevel:Picard'),
              (" Backward Euler scheme and Newton's method ",
               2,
               'nonlin:pdelevel:Newton',
               'nonlin:pdelevel:Newton'),
              (' Linearization via Taylor expansions ', 3, None, '___sec27'),
              (' Similarity with Picard iteration ', 3, None, '___sec28'),
              (' Implementation ', 3, None, '___sec29'),
              (' Crank-Nicolson discretization ',
               2,
               'nonlin:pdelevel:Picard:CN',
               'nonlin:pdelevel:Picard:CN'),
              (' Discretization of stationary nonlinear differential equations ',
               1,
               'nonlin:alglevel:1D',
               'nonlin:alglevel:1D'),
              (' Finite difference discretizations ',
               2,
               'nonlin:alglevel:1D:fd',
               'nonlin:alglevel:1D:fd'),
              (' Solution of algebraic equations ', 2, None, '___sec33'),
              (' The structure of the equation system ', 3, None, '___sec34'),
              (' Picard iteration ', 3, None, '___sec35'),
              (" Newton's method ", 3, None, '___sec36'),
              (' Galerkin-type discretizations ',
               2,
               'nonlin:alglevel:1D:fe',
               'nonlin:alglevel:1D:fe'),
              (' Fundamental integration problem ', 3, None, '___sec38'),
              (' Finite element basis functions ', 2, None, '___sec39'),
              (' The group finite element method ',
               2,
               'nonlin:alglevel:1D:fe:group',
               'nonlin:alglevel:1D:fe:group'),
              (' Finite element approximation of functions of $u$ ',
               3,
               None,
               '___sec41'),
              (' Simplified problem ', 3, None, '___sec42'),
              (' Integrating nonlinear functions ', 3, None, '___sec43'),
              (' Application of the group finite element method ',
               3,
               None,
               '___sec44'),
              (' Numerical integration of nonlinear terms ',
               2,
               'nonlin:alglevel:1D:fe:f',
               'nonlin:alglevel:1D:fe:f'),
              (' Finite element discretization of a variable coefficient Laplace term ',
               2,
               'nonlin:alglevel:1D:fe:Laplace',
               'nonlin:alglevel:1D:fe:Laplace'),
              (' Group finite element method ', 3, None, '___sec47'),
              (' Numerical integration at the nodes ', 3, None, '___sec48'),
              (' Picard iteration defined from the variational form ',
               2,
               'nonlin:alglevel:1D:fe:Picard',
               'nonlin:alglevel:1D:fe:Picard'),
              (" Newton's method defined from the variational form ",
               2,
               'nonlin:alglevel:1D:fe:Newton',
               'nonlin:alglevel:1D:fe:Newton'),
              (' Dirichlet conditions ', 3, None, '___sec51'),
              (' Multi-dimensional PDE problems ', 1, None, '___sec52'),
              (' Finite element discretization ',
               2,
               'nonlin:alglevel:dD:fe',
               'nonlin:alglevel:dD:fe'),
              (' Non-homogeneous Neumann conditions ', 3, None, '___sec54'),
              (' Robin conditions ', 3, None, '___sec55'),
              (' Finite difference discretization ', 2, None, '___sec56'),
              (' Continuation methods ', 2, None, '___sec57'),
              (' Exercises ', 1, 'nonlin:exer', 'nonlin:exer'),
              (' Problem 1: Determine if equations are nonlinear or not ',
               2,
               'nonlin:exer:lin:vs:nonlin',
               'nonlin:exer:lin:vs:nonlin'),
              (' Exercise 2: Derive a formula ',
               2,
               'nonlin:exer:relax:formula',
               'nonlin:exer:relax:formula'),
              (" Problem 3: Experience the behavior of Newton's method ",
               2,
               'nonlin:exer:Newton:problems1',
               'nonlin:exer:Newton:problems1'),
              (' Problem 4: Linearize a nonlinear vibration ODE ',
               2,
               'nonlin:exer:vib:geometric:mean',
               'nonlin:exer:vib:geometric:mean'),
              (' Exercise 5: Find the sparsity of the Jacobian ',
               2,
               'nonlin:exer:sparsity:Jacobian',
               'nonlin:exer:sparsity:Jacobian'),
              (" Exercise 6: Newton's method for linear problems ",
               2,
               'nonlin:exer:Newton:linear',
               'nonlin:exer:Newton:linear'),
              (' Exercise 7: Differentiate a highly nonlinear term ',
               2,
               'nonlin:exer:grad:pow:term',
               'nonlin:exer:grad:pow:term'),
              (' Problem 8: Discretize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:fem',
               'nonlin:exer:1D:1pu2:fem'),
              (' Problem 9: Linearize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:PicardNewton',
               'nonlin:exer:1D:1pu2:PicardNewton'),
              (' Problem 10: Finite differences for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fd',
               'nonlin:exer:1D:fu:discretize:fd'),
              (' Problem 11: Integrate functions of finite element expansions ',
               2,
               'nonlin:exer:fu:fem:int',
               'nonlin:exer:fu:fem:int'),
              (' Problem 12: Finite elements for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fe',
               'nonlin:exer:1D:fu:discretize:fe'),
              (' Problem 13: Derive the Newton system from a variational form ',
               2,
               'nonlin:exer:dD:heat:nonlinear:c:a',
               'nonlin:exer:dD:heat:nonlinear:c:a'),
              (' Problem 14: Derive algebraic equations for nonlinear 1D heat conduction ',
               2,
               'nonlin:exer:1D:heat:nonlinear:c:a',
               'nonlin:exer:1D:heat:nonlinear:c:a'),
              (' Problem 15: Investigate a 1D problem with a continuation method ',
               2,
               'nonlin:exer:continuation:1DnNflow',
               'nonlin:exer:continuation:1DnNflow'),
              (' Bibliography ', 1, None, '___sec74')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
$$




    
<a name="part0005"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._main_nonlin-solarized004.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._main_nonlin-solarized006.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1>Multi-dimensional PDE problems  <a name="___sec52"></a></h1>

<h2>Finite element discretization <a name="nonlin:alglevel:dD:fe"></a></h2>

<p>
The derivation of \( F_i \) and \( J_{i,j} \) in the 1D model problem
is easily generalized to multi-dimensional problems.
For example, Backward Euler discretization of the
PDE

$$
\begin{equation}
u_t = \nabla\cdot(\dfc(u)\nabla u) + f(u),
\tag{45}
\end{equation}
$$

gives the nonlinear time-discrete PDEs

$$ u^n - \Delta t\nabla\cdot(\dfc(u^n)\nabla u^n) + f(u^n) = u^{n-1},$$

or with \( u^n \) simply as \( u \) and \( u^{n-1} \) as \( u^{(1)} \),

$$ u - \Delta t\nabla\cdot(\dfc(u^n)\nabla u) - \Delta t f(u) = u^{(1)}\tp$$

The variational form, assuming homogeneous Neumann conditions
for simplicity, becomes

$$
\begin{equation}
\int_\Omega (uv + \Delta t\dfc(u)\nabla u\cdot\nabla v
- \Delta t f(u)v - u^{(1)} v)\dx\tp
\tag{46}
\end{equation}
$$

The nonlinear algebraic equations follow from setting \( v=\baspsi_i \)
and using the representation \( u=\sum_kc_k\baspsi_k \), which we
just write as

$$
\begin{equation}
F_i =
\int_\Omega (u\baspsi_i + \Delta t\dfc(u)\nabla u\cdot\nabla \baspsi_i
- \Delta t f(u)\baspsi_i - u^{(1)}\baspsi_i)\dx\tp
\tag{47}
\end{equation}
$$

Picard iteration needs a linearization where we use
the most recent approximation \( u^{-} \) to \( u \) in
\( \dfc \) and \( f \):

$$
\begin{equation}
F_i \approx \hat F_i =
\int_\Omega (u\baspsi_i + \Delta t\dfc(u^{-})\nabla u\cdot\nabla \baspsi_i
- \Delta t f(u^{-})\baspsi_i - u^{(1)}\baspsi_i)\dx\tp
\tag{48}
\end{equation}
$$

The equations \( \hat F_i=0 \) are now linear and we can easily derive
a linear system for the unknown coefficients
\( \sequencei{c} \) by inserting \( u=\sum_jc_j\baspsi_j \).

<p>
In Newton's method we need to evaluate \( F_i \) with the known value
\( u^{-} \) for \( u \):

$$
\begin{equation}
F_i \approx \hat F_i =
\int_\Omega (u^{-}\baspsi_i + \Delta t\dfc(u^{-})
\nabla u^{-}\cdot\nabla \baspsi_i
- \Delta t f(u^{-})\baspsi_i - u^{(1)}\baspsi_i)\dx\tp
\tag{49}
\end{equation}
$$

The Jacobian is obtained by differentiating
<a href="#mjx-eqn-47">(47)</a> and using \( \partial u/\partial c_j=\baspsi_j \):

$$
\begin{align}
J_{i,j} = \frac{\partial F_i}{\partial c_j} =
\int_\Omega & (\baspsi_j\baspsi_i + \Delta t\dfc^{\prime}(u)\baspsi_j
\nabla u\cdot\nabla \baspsi_i +
\Delta t\dfc(u)\nabla\baspsi_j\cdot\nabla\baspsi_i - \nonumber\\ 
&\ \Delta t f^{\prime}(u)\baspsi_j\baspsi_i)\dx\tp
\tag{51}
\end{align}
$$

The evaluation of \( J_{i,j} \) as the coefficient matrix in the linear
system in Newton's method applies the known approximation \( u^{-} \)
for \( u \):

$$
\begin{align}
J_{i,j} =
\int_\Omega & (\baspsi_j\baspsi_i + \Delta t\dfc^{\prime}(u^{-})\baspsi_j
\nabla u^{-}\cdot\nabla \baspsi_i +
\Delta t\dfc(u^{-})\nabla\baspsi_j\cdot\nabla\baspsi_i - \nonumber\\ 
&\ \Delta t f^{\prime}(u^{-})\baspsi_j\baspsi_i)\dx\tp
\tag{51}
\end{align}
$$

Hopefully, these example also show how convenient the notation
with \( u \) and \( u^{-} \) is: the unknown to be computed is always \( u \) and
linearization by inserting known (previously computed) values
is a matter of adding an underscore.
One can take great advantage of this quick notation in
software <a href="._main_nonlin-solarized006.html#Mortensen_et_al_2011">[2]</a>.

<h3>Non-homogeneous Neumann conditions  <a name="___sec54"></a></h3>

<p>
A natural physical flux condition for the PDE <a href="#mjx-eqn-45">(45)</a>
takes the form of a non-homogeneous Neumann condition

$$
\begin{equation}
-\dfc(u)\frac{\partial u}{\partial n} = g,\quad\x\in\partial\Omega_N,
\tag{52}
\end{equation}
$$

where \( g \) is a prescribed function and \( \partial\Omega_N \) is a part
of the boundary of the domain \( \Omega \). From integrating
\( \int_\Omega\nabla\cdot(\dfc\nabla u)\dx \) by parts, we get a boundary term

$$
\begin{equation}
\int_{\partial\Omega_N}\dfc(u)\frac{\partial u}{\partial u}v\ds\tp
\tag{53}
\end{equation}
$$

Inserting the condition <a href="#mjx-eqn-52">(52)</a> into
this term results in an integral over prescribed values: \( -\int_{\partial\Omega_N}gv\ds \). The nonlinearity in the \( \dfc(u) \) coefficient condition
<a href="#mjx-eqn-52">(52)</a> therefore does not contribute with
a nonlinearity in the variational form.

<h3>Robin conditions  <a name="___sec55"></a></h3>

<p>
Heat conduction problems often apply a kind of Newton's cooling law,
also known as a Robin condition, at the boundary:

$$
\begin{equation}
-\dfc(u)\frac{\partial u}{\partial u} = h_T(u)(u-T_s(t)),\quad\x\in\partial\Omega_R,
\tag{54}
\end{equation}
$$

where \( h_T(u) \) is a heat transfer coefficient between the body (\( \Omega \))
and its surroundings, \( T_s \) is the temperature of the surroundings,
and \( \partial\Omega_R \) is a part of the boundary where this Robin
condition applies. The boundary integral
<a href="#mjx-eqn-53">(53)</a> now becomes

$$ \int_{\partial\Omega_R}h_T(u)(u-T_s(T))v\ds,$$

by replacing \( \dfc(u)\partial u/\partial u \) by \( h_T(u-T_s) \).
Often, \( h_T(u) \) can be taken as constant, and then the boundary
term is linear in \( u \), otherwise it is nonlinear and contributes
to the Jacobian in a Newton method.
Linearization in a Picard method will typically use a known value
in \( h_T \), but keep the \( u \) in \( u-T_s \) as unknown:
\( h_T(u^{-})(u-T_s(t)) \).

<h2>Finite difference discretization  <a name="___sec56"></a></h2>

<p>
A typical diffusion equation

$$ u_t = \nabla\cdot(\dfc(u)\nabla u) + f(u),$$

can be discretized by (e.g.) a Backward Euler scheme,
which in 2D can be written

$$ [D_t^- u = D_x\overline{\dfc}^xD_x u
+ D_y\overline{\dfc}^yD_y u + f(u)]_{i,j}^n\tp
$$

We do not dive into details of boundary conditions now. Dirichlet and
Neumann conditions are handled as in linear diffusion problems.

<p>
Writing the scheme out, putting the unknown values on the
left-hand side and known values on the right-hand side, and
introducing \( \Delta x=\Delta y=h \) to save some writing, one gets

$$
\begin{align*}
u^n_{i,j} &- \frac{\Delta t}{h^2}(
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i+1,j}^n))(u_{i+1,j}^n-u_{i,j}^n)\\ 
&\quad -
\half(\dfc(u_{i-1,j}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j}^n) \\ 
&\quad +
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i,j+1}^n))(u_{i,j+1}^n-u_{i,j}^n)\\ 
&\quad -
 \half(\dfc(u_{i,j-1}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j-1}^n))
- \Delta tf(u_{i,j}^n) = u^{n-1}_{i,j}
\end{align*}
$$

This defines a nonlinear algebraic system \( A(u)u=b(u) \).
A Picard iteration applies old values \( u^{-} \) in \( \dfc \) and \( f \),
or equivalently, old values for \( u \) in \( A(u) \) and \( b(u) \).
The result is a linear system of the same type as those arising
from \( u_t = \nabla\cdot (\dfc(\x)\nabla u) + f(\x,t) \).

<p>
Newton's method is as usual more involved. We first define
the nonlinear algebraic equations to be solved, drop the
superscript \( n \), and introduce \( u^{(1)} \) for \( u^{n-1} \):

$$
\begin{align*}
F_{i,j} &= u^n_{i,j} - \frac{\Delta t}{h^2}(\\ 
&\quad \half(\dfc(u_{i,j}^n)   + \dfc(u_{i+1,j}^n))(u_{i+1,j}^n-u_{i,j}^n) -
 \half(\dfc(u_{i-1,j}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j}^n) + \\ 
&\quad
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i,j+1}^n))(u_{i,j+1}^n-u_{i,j}^n) -
 \half(\dfc(u_{i,j-1}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j-1}^n)) -\\ 
&\quad \Delta tf(u_{i,j}^n) - u^{n-1}_{i,j} = 0\tp
\end{align*}
$$

It is convenient to work with two indices \( i \) and \( j \) in 2D
finite difference discretizations, but it complicates
the derivation of the Jacobian, which then gets four indices.
The left-hand expression of an equation \( F_{i,j}=0 \) is to be
differentiated with respect to each of the unknowns \( u_{r,s} \)
(short for \( u_{r,s}^n \)), \( r\in\Ix \), \( s\in\Iy \),

$$ J_{i,j,r,s} = \frac{\partial F_{i,j}}{\partial u_{r,s}}\tp $$

Given \( i \) and \( j \), only a few \( r \) and \( s \) indices give nonzero
contribution since \( F_{i,j} \) contains \( u_{i\pm 1,j} \), \( u_{i,j\pm 1} \),
and \( u_{i,j} \). Therefore, \( J_{i,j,r,s} \) is very sparse and we
can set up the left-hand side of the Newton system as

$$
\begin{align*}
 J_{i,j,r,s}\delta u_{r,s} =
J_{i,j,i,j}\delta u_{i,j} & +
J_{i,j,i-1,j}\delta u_{i-1,j} +
J_{i,j,i+1,j}\delta u_{i+1,j} +
J_{i,j,i,j-1}\delta u_{i,j-1}\\ 
& +
J_{i,j,i,j+1}\delta u_{i,j+1}
\end{align*}
$$

The specific derivatives become

$$
\begin{align*}
J_{i,j,i-1,j} &= \frac{\partial F_{i,j}}{\partial u_{i-1,j}}\\ 
&= \frac{\Delta t}{h^2}(\dfc^{\prime}(u_{i-1,j})(u_{i,j}-u_{i-1,j})
+ \dfc(u_{i-1,j})(-1))\\ 
J_{i,j,i+1,j} &= \frac{\partial F_{i,j}}{\partial u_{i+1,j}}\\ 
&= \frac{\Delta t}{h^2}(-\dfc^{\prime}(u_{i+1,j})(u_{i+1,j}-u_{i,j})
- \dfc(u_{i-1,j}))\\ 
J_{i,j,i,j-1} &= \frac{\partial F_{i,j}}{\partial u_{i,j-1}}\\ 
&= \frac{\Delta t}{h^2}(\dfc^{\prime}(u_{i,j-1})(u_{i,j}-u_{i,j-1})
+ \dfc(u_{i,j-1})(-1))\\ 
J_{i,j,i,j+1} &= \frac{\partial F_{i,j}}{\partial u_{i,j+1}}\\ 
&= \frac{\Delta t}{h^2}(-\dfc^{\prime}(u_{i,j+1})(u_{i,j+1}-u_{i,j})
- \dfc(u_{i,j-1}))
\end{align*}
$$

The \( J_{i,j,i,j} \) entry has a few more terms.
Inserting \( u^{-} \) for \( u \) in the \( J \) formula and then
forming \( J\delta u=-F \) gives the linear system to be solved
in each Newton iteration.

<h2>Continuation methods  <a name="___sec57"></a></h2>

<p>
Picard iteration or Newton's method may diverge when solving PDEs with
severe nonlinearities. Relaxation with \( \omega < 1 \)
may help, but in highly nonlinear problems it can be
necessary to introduce a <em>continuation parameter</em> \( \Lambda \) in
the problem: \( \Lambda =0 \) gives a version of the
problem that is easy to solve, while
\( \Lambda =1 \) is the target problem. The idea is then
to increase \( \Lambda \) in steps, \( \Lambda_0=0 ,\Lambda_1 < \cdots < \Lambda_n=1 \),
and use the solution from the problem with \( \Lambda_{i-1} \) as
initial guess for the iterations in the problem corresponding
to \( \Lambda_i \).

<p>
The continuation method is easiest to understand through an example.
Suppose we intend to solve

$$ -\nabla\cdot\left( ||\nabla u||^q\nabla u\right) = f, $$

which is an equation modeling the flow of a non-Newtonian fluid through
i channel or pipe. For \( q=0 \) we have the Poisson equation (corresponding
to a Newtonian fluid) and the problem is linear. A typical
value for pseudo-plastic fluids may be \( q_n=-0.8 \). We can introduce
the continuation parameter \( \Lambda\in [0,1] \) such that
\( q=q_n\Lambda \). Let \( \{\Lambda_\ell\}_{\ell=0}^n \) be the sequence of
\( \Lambda \) values in \( [0,1] \), with corresponding \( q \) values
\( \{q_\ell\}_{\ell=0}^n \). We can then solve a sequence of problems

$$
-\nabla\cdot\left( ||\nabla u||^q_\ell\nabla u^\ell\right) = f,\quad
\ell = 0,\ldots,n,$$

where the initial guess for iterating on \( u^{\ell} \) is the
previously computed solution \( u^{\ell-1} \). If a particular \( \Lambda_\ell \)
leads to convergence problems, one may try a smaller
increase in \( \Lambda \):
\( \Lambda_* = \half (\Lambda_{\ell-1}+\Lambda_\ell) \),
and repeat halving the step in \( \Lambda \) until convergence is reestablished.

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._main_nonlin-solarized004.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._main_nonlin-solarized006.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

