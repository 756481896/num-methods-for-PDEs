<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Stationary variational forms">
<meta name="keywords" content="residual,weighted residuals,method of weighted residuals,variational formulation,weak formulation,trial function,test function,trial space,test space,integration by parts,weak form,strong form,natural boundary condition,essential boundary condition">

<title>Stationary variational forms</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Basic principles for approximating differential equations',
               1,
               'fem:deq:1D:principles',
               'fem:deq:1D:principles'),
              ('Differential equation models',
               2,
               'fem:deq:1D:models',
               'fem:deq:1D:models'),
              ('Simple model problems and their solutions',
               2,
               'fem:deq:1D:models:simple',
               'fem:deq:1D:models:simple'),
              ('Forming the residual',
               2,
               'fem:deq:1D:residual:min',
               'fem:deq:1D:residual:min'),
              ('The least squares method', 2, None, '___sec4'),
              ('The Galerkin method', 2, None, '___sec5'),
              ('The Method of Weighted Residuals', 2, None, '___sec6'),
              ('Test and Trial Functions', 2, None, '___sec7'),
              ('The collocation method', 2, None, '___sec8'),
              ('The subdomain collocation method', 3, None, '___sec9'),
              ('Examples on using the principles',
               2,
               'fem:deq:1D:ex:sines',
               'fem:deq:1D:ex:sines'),
              ('The model problem', 3, None, '___sec11'),
              ('Basis functions', 3, None, '___sec12'),
              ('The residual', 3, None, '___sec13'),
              ('The least squares method', 3, None, '___sec14'),
              ('The Galerkin method', 3, None, '___sec15'),
              ('The collocation method', 3, None, '___sec16'),
              ('Comparison', 3, None, '___sec17'),
              ('Integration by parts',
               2,
               'fem:deq:1D:varform',
               'fem:deq:1D:varform'),
              ('Weak form', 3, None, '___sec19'),
              ('Boundary function',
               2,
               'fem:deq:1D:essBC:Bfunc',
               'fem:deq:1D:essBC:Bfunc'),
              ('Abstract notation for variational formulations',
               2,
               'fem:deq:1D:varform:abstract',
               'fem:deq:1D:varform:abstract'),
              ('Variational problems and minimization of functionals',
               2,
               'fem:deq:1D:optimization',
               'fem:deq:1D:optimization'),
              ('Example', 3, None, '___sec23'),
              ('The general minimization problem', 3, None, '___sec24'),
              ('Derivation', 3, None, '___sec25'),
              ('Minimization of the discretized functional',
               3,
               None,
               '___sec26'),
              ('Calculus of variations', 3, None, '___sec27'),
              ('Examples on variational formulations',
               1,
               'fem:deq:1D:varform:ex',
               'fem:deq:1D:varform:ex'),
              ('Variable coefficient', 2, None, '___sec29'),
              ('First-order derivative in the equation and boundary condition',
               2,
               None,
               '___sec30'),
              ('Nonlinear coefficient', 2, None, '___sec31'),
              ('Computing with Dirichlet and Neumann conditions',
               2,
               'fem:deq:1D:varform:ex:DN:case',
               'fem:deq:1D:varform:ex:DN:case'),
              ('When the numerical method is exact', 2, None, '___sec33'),
              ('Computing with finite elements',
               1,
               'fem:deq:1D:fem1',
               'fem:deq:1D:fem1'),
              ('Finite element mesh and basis functions',
               2,
               None,
               '___sec35'),
              ('Computation in the global physical domain',
               2,
               'fem:deq:1D:comp:global',
               'fem:deq:1D:comp:global'),
              ('Comparison with a finite difference discretization',
               2,
               'fem:deq:1D:fdm_vs_fem',
               'fem:deq:1D:fdm_vs_fem'),
              ('Cellwise computations',
               2,
               'fem:deq:1D:comp:elmwise',
               'fem:deq:1D:comp:elmwise'),
              ('The integral for the element matrix', 3, None, '___sec39'),
              ('The integral for the element vector', 3, None, '___sec40'),
              ('Detailed calculations of the element matrix and vector',
               3,
               None,
               '___sec41'),
              ('Contributions from the first and last cell',
               3,
               None,
               '___sec42'),
              ('Assembly', 3, None, '___sec43'),
              ('Boundary conditions: specified nonzero value',
               1,
               'fem:deq:1D:essBC',
               'fem:deq:1D:essBC'),
              ('General construction of a boundary function',
               2,
               'fem:deq:1D:fem:essBC:Bfunc',
               'fem:deq:1D:fem:essBC:Bfunc'),
              ('Example on computing with a finite element-based boundary function',
               2,
               None,
               '___sec46'),
              ('Computations in physical coordinates', 3, None, '___sec47'),
              ('Cellwise computations on the reference element',
               3,
               None,
               '___sec48'),
              ('Modification of the linear system',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys',
               'fem:deq:1D:fem:essBC:Bfunc:modsys'),
              ('Computations in the physical system', 3, None, '___sec50'),
              ('Symmetric modification of the linear system',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm',
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm'),
              ('Modification of the element matrix and vector',
               2,
               None,
               '___sec52'),
              ('Boundary conditions: specified derivative',
               1,
               'fem:deq:1D:BC:nat',
               'fem:deq:1D:BC:nat'),
              ('The variational formulation', 2, None, '___sec54'),
              ('Boundary term vanishes because of the test functions',
               2,
               'fem:deq:1D:BC:nat:uLtest',
               'fem:deq:1D:BC:nat:uLtest'),
              ('Boundary term vanishes because of linear system modifications',
               2,
               'fem:deq:1D:BC:nat:uLmod',
               'fem:deq:1D:BC:nat:uLmod'),
              ('Direct computation of the global linear system',
               2,
               'fem:deq:1D:BC:nat:Aub',
               'fem:deq:1D:BC:nat:Aub'),
              ('Cellwise computations', 2, None, '___sec58'),
              ('Implementation', 1, 'fem:deq:1D:code', 'fem:deq:1D:code'),
              ('Global basis functions',
               2,
               'fem:deq:1D:code:global',
               'fem:deq:1D:code:global'),
              ('Example: constant right-hand side', 2, None, '___sec61'),
              ('Finite elements',
               2,
               'fem:deq:1D:code:fe',
               'fem:deq:1D:code:fe'),
              ('Utilizing a sparse matrix',
               2,
               'fem:deq:1D:code:fe_sparse',
               'fem:deq:1D:code:fe_sparse'),
              ('Example', 3, None, '___sec64'),
              ('Variational formulations in 2D and 3D',
               1,
               'fem:deq:2D:varform',
               'fem:deq:2D:varform'),
              ('Integration by parts', 2, None, '___sec66'),
              ('Example on a multi-dimensional variational problem',
               2,
               None,
               '___sec67'),
              ('Transformation to a reference cell in 2D and 3D',
               2,
               None,
               '___sec68'),
              ('Numerical integration', 2, None, '___sec69'),
              ('Convenient formulas for P1 elements in 2D',
               2,
               None,
               '___sec70'),
              ('A glimpse of the mathematical theory of the finite element method',
               2,
               None,
               '___sec71'),
              ('Abstract variational forms', 3, None, '___sec72'),
              ('Example on an abstract variational form and associated spaces',
               3,
               None,
               '___sec73'),
              ('Assumptions', 3, None, '___sec74'),
              ('Existence and uniqueness', 3, None, '___sec75'),
              ('Stability', 3, None, '___sec76'),
              ('Equivalent minimization problem', 3, None, '___sec77'),
              ('Best approximation principle', 3, None, '___sec78'),
              ('Best approximation property in the norm of the space',
               3,
               None,
               '___sec79'),
              ('Symmetric, positive definite coefficient matrix',
               3,
               None,
               '___sec80'),
              ('Equivalent matrix minimization problem', 3, None, '___sec81'),
              ('A priori error estimate for the derivative',
               3,
               None,
               '___sec82'),
              ('A priori error estimate for the solution',
               3,
               None,
               '___sec83'),
              ('Summary', 1, None, '___sec84'),
              ('Exercises', 1, None, '___sec85'),
              ('Exercise 1: Refactor functions into a more general class',
               2,
               'fem:deq:exer:BVP1D:class',
               'fem:deq:exer:BVP1D:class'),
              ('Exercise 2: Compute the deflection of a cable with sine functions',
               2,
               'fem:deq:exer:tension:cable',
               'fem:deq:exer:tension:cable'),
              ('Least squares method', 3, None, '___sec88'),
              ("Galerkin's method", 3, None, '___sec89'),
              ('Decay of coefficients', 3, None, '___sec90'),
              ('Error in one-term solution', 3, None, '___sec91'),
              ('Exercise 3: Compute the deflection of a cable with power functions',
               2,
               'fem:deq:exer:tension:cable_xn',
               'fem:deq:exer:tension:cable_xn'),
              ('Exercise 4: Check integration by parts',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              ('Exercise 5: Compute the deflection of a cable with 2 P1 elements',
               2,
               'fem:deq:exer:cable:2P1',
               'fem:deq:exer:cable:2P1'),
              ('Method 1: Excluding the unknown at $x=0$',
               3,
               None,
               '___sec95'),
              ('Method 2: Modifying the linear system', 3, None, '___sec96'),
              ('Exercise 6: Compute the deflection of a cable with 1 P2 element',
               2,
               'fem:deq:exer:cable:1P2',
               'fem:deq:exer:cable:1P2'),
              ('Method 1: Excluding the unknown at $x=0$',
               3,
               None,
               '___sec98'),
              ('Method 2: Modifying the linear system', 3, None, '___sec99'),
              ('Exercise 7: Compute the deflection of a cable with a step load',
               2,
               'fem:deq:exer:cable:stepload',
               'fem:deq:exer:cable:stepload'),
              ('Exercise 8: Compute with a non-uniform mesh',
               2,
               'fem:deq:exer:1D:mesh:nonuniform',
               'fem:deq:exer:1D:mesh:nonuniform'),
              ('Problem 9: Solve a 1D finite element problem by hand',
               2,
               'fem:deq:exer:1D:gen:problem1',
               'fem:deq:exer:1D:gen:problem1'),
              ('Exercise 10: Investigate exact finite element solutions',
               2,
               'fem:deq:exer:1D:exact_numerics',
               'fem:deq:exer:1D:exact_numerics'),
              ('Plots for m=0', 3, None, '___sec104'),
              ('Plots for m=1', 3, None, '___sec105'),
              ('Plots for m=2', 3, None, '___sec106'),
              ('Plots for m=3', 3, None, '___sec107'),
              ('Plots for m=4', 3, None, '___sec108'),
              ('Exercise 11: Compare finite elements and differences for a radially symmetric Poisson equation',
               2,
               'fem:deq:exer:1D:Poisson:polar',
               'fem:deq:exer:1D:Poisson:polar'),
              ('Exercise 12: Compute with variable coefficients and P1 elements by hand',
               2,
               'fem:deq:exer:1D:gen:problem2',
               'fem:deq:exer:1D:gen:problem2'),
              ('Exercise 13: Solve a 2D Poisson equation using polynomials and sines',
               2,
               'fem:deq:exer:2D:torsion:xy:sin',
               'fem:deq:exer:2D:torsion:xy:sin'),
              ('Bibliography', 1, None, '___sec112')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}
\newcommand{\sequencej}[1]{\left\{ {#1}_j \right\}_{j\in\If}}
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
$$




    
<a name="part0009"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._varform-solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._varform-solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="___sec85">Exercises </h1>

<p>
<!-- examples on model4 with 1, x, x^2 etc. Show that N=2 recovers -->
<!-- the exact solution -->

<p>
<!-- heat conduction in the ground with radioactivity, need good  model, not -->
<!-- just the old one -->
<!-- string with load -->
<!-- hanging cable, see ideas/5620 articles about that (nonlinear) -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:BVP1D:class">Exercise 1: Refactor functions into a more general class</h2>

<p>
The section <a href="._varform-solarized001.html#fem:deq:1D:models:simple">Simple model problems and their solutions</a> lists three functions for
computing the analytical solution of some simple model problems. There
is quite some repetitive code, suggesting that the functions can
benefit from being refactored into a class hierarchy, where the super
class solves \( -(a(x)u'(x))'=f(x) \) and where subclasses define the
equations for the boundary conditions in a model. Make a method for
returning the residual in the differential equation and the boundary
conditions when the solution is inserted in these equations. Create a
test function that verifies that all three residuals vanish for each
of the model problems in the section <a href="._varform-solarized001.html#fem:deq:1D:models:simple">Simple model problems and their solutions</a>.  Also
make a method that returns the solution either as <code>sympy</code> expression
or as a string in LaTeX format.  Add a fourth subclass for the problem
\( -(au')'=f \) with a Robin boundary condition:

$$ u(0)=0,\quad -u'(L) = C(u - D)\tp$$

Demonstrate the use of this subclass for the case \( f=0 \) and \( a=\sqrt{1+x} \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>uxx_f_sympy_class</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</h2>

<p>
A hanging cable of length \( L \)
with significant tension \( T \) has a deflection \( w(x) \)
governed by

$$
T w''(x) = \ell(x),
$$

where \( \ell(x) \) the vertical load per unit length.
The cable is fixed at \( x=0 \) and \( x=L \) so the boundary conditions become
\( w(0)=w(L)=0 \). The deflection \( w \) is positive upwards, and \( \ell \) is
positive when it acts downwards.

<p>
If we assume a constant load \( \ell(x)=\hbox{const} \),
the solution is expected to be symmetric around \( x=L/2 \). For a function
\( w(x) \) that is symmetric around some point \( x_0 \), it means that
\( w(x_0-h) = w(x_0+h) \), and then \( w'(x_0)=\lim_{h\rightarrow 0}(w(x_0+h)-
w(x_0-h))/(2h)=0 \). We can therefore utilize symmetry to halve the domain.
We then seek \( w(x) \) in \( [0,L/2] \) with boundary conditions \( w(0)=0 \) and
\( w'(L/2)=0 \).

<p>
The problem can be scaled by introducing dimensionless independent
and dependent variables,

$$ \bar x = \frac{x}{L/2},\quad \bar u = \frac{w}{w_c},$$

where \( w_c \) is a characteristic size of \( w \).
Inserted in the problem for \( w \),

$$ \frac{4Tw_c}{L^{2}}\frac{d^2\bar u}{d\bar x^2} = \ell\ (= \hbox{const})\tp$$

A desire is to have \( u \) and its derivatives about unity, so
choosing \( w_c \) such that \( |d^2\bar u/d\bar x^2|=1 \) is an idea.
Then \( w_c=\frac{1}{4}\ell L^2/T \), and the problem for the scaled vertical
deflection \( u \) becomes

$$
u'' = 1,\quad x\in (0,1),\quad u(0)=0,\ u'(1)=0\tp
$$

Observe that there are no physical parameters in this scaled problem.
From now on we have for convenience
renamed \( x \) to be the scaled quantity \( \bar x \).

<p>
<b>a)</b>
Find the exact solution for the deflection \( u \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
A possible function space is spanned by \( \baspsi_i=\sin ((2i+1)\pi x/2) \),
\( i=0,\ldots,N \). These functions
fulfill the necessary condition \( \baspsi_i(0)=0 \),
but they also fulfill \( \baspsi_i'(1)=0 \) such that both boundary
conditions are fulfilled by the expansion \( u=\sum_jc_j\basphi_j \).

<p>
Use a Galerkin and a least squares method to find the coefficients
\( c_j \) in \( u(x)=\sum_j c_j\baspsi_j \). Find how fast the coefficients
decrease in magnitude by looking at \( c_j/c_{j-1} \).
Find the error in the maximum deflection at \( x=1 \) when only one
basis function is used (\( N=0 \)).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
In this case, where the basis functions and their derivatives are
orthogonal, it is easiest to set up the calculations by hand and
use <code>sympy</code> to help out with the integrals.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Visualize the solutions in b) for \( N=0,1,20 \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>d)</b>
The functions in b) were selected such that they fulfill the
condition \( \baspsi'(1)=0 \). However, in the Galerkin method, where we
integrate by parts, the condition \( u'(1)=0 \) is incorporated in the
variational form. This leads to the idea of just choosing a simpler
basis, namely &quot;all&quot; sine functions \( \baspsi_i = \sin((i+1)\frac{\pi x}{2}) \).
Will the method adjust the coefficient such that the additional
functions compared with those in b) get vanishing coefficients? Or
will the additional basis functions improve the solution?
Use Galerkin's method.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>e)</b>
Now we drop the symmetry condition at \( x=1 \) and extend the domain to
\( [0,2] \) such that it covers the entire (scaled) physical cable. The
problem now reads

$$ u'' = 1,\quad x\in (0,2),\quad u(0)=u(2)=0\tp$$

This time we need basis functions that are zero at \( x=0 \) and \( x=2 \).
The set \( \sin((i+1)\frac{\pi x}{2}) \) from d) is a candidate since
they vanish \( x=2 \) for any \( i \). Compute the approximation in this case.
Why is this approximation without the problem that this set of
basis functions introduced in d)?

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<!-- BIG point: use polynomials, without integration by parts we cannot -->
<!-- handle the boundary condition. -->

<p>
Filename: <code>cable_sin</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:tension:cable_xn">Exercise 3: Compute the deflection of a cable with power functions</h2>

<p>
<b>a)</b>
Repeat <a href="#fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</a> b), but work with
the space

$$ V = \hbox{span}\{x, x^2, x^3, x^4, \ldots\}\tp $$

Choose the dimension of \( V \) to be 4 and observe that the exact solution
is recovered by the Galerkin method.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Use the <code>solver</code> function from <code>varform1D.py</code>.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
What happens if we use a least squares method for this problem with
the basis in a)?

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>cable_xn</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:intg:parts">Exercise 4: Check integration by parts</h2>

<p>
Consider the Galerkin method for the problem involving \( u \)
in <a href="#fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</a>.
Show that the formulas for \( c_j \) are independent of whether we perform
integration by parts or not.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>cable_integr_by_parts</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:cable:2P1">Exercise 5: Compute the deflection of a cable with 2 P1 elements</h2>

<p>
Solve the problem for \( u \) in <a href="#fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</a>
using two P1 linear elements. Incorporate the condition \( u(0)=0 \)
by two methods: 1) excluding the unknown at \( x=0 \), 2) keeping the unknown
at \( x=0 \), but modifying the linear system.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>cable_2P1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:cable:1P2">Exercise 6: Compute the deflection of a cable with 1 P2 element</h2>

<p>
Solve the problem for \( u \) in <a href="#fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</a>
using one P2 element with quadratic basis functions.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>cable_1P2</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:cable:stepload">Exercise 7: Compute the deflection of a cable with a step load</h2>

<p>
We consider the deflection of a tension cable as described in
<a href="#fem:deq:exer:tension:cable">Exercise 2: Compute the deflection of a cable with sine functions</a>: \( w''=\ell \), \( w(0)=w(L)=0 \).
Now the load is discontinuous:

$$ \ell (x) =\left\lbrace\begin{array}{ll}
\ell_1, & x < L/2,\\ 
\ell_2, & x \geq L/2
\end{array}\right.\quad x\in [0,L]
\tp
$$

This load is not symmetric
with respect to the midpoint \( x=L/2 \) so the solution loses its symmetry.
Scaling the problem by introducing

$$ \bar x = \frac{x}{L/2},\quad u = \frac{w}{w_c},\quad\bar\ell = \frac{\ell - \ell_1}{\ell_2 - \ell_1}\tp$$

This leads to a scaled problem on \( [0,2] \) (we rename \( \bar x \) as \( x \)
for convenience):

$$ u'' = \bar\ell(x) = \left\lbrace\begin{array}{ll}
1, & x < 1,\\ 
0, & x \geq 1
\end{array}\right.
\quad x\in (0,1),\quad u(0)=0,\ u(2)=0
\tp $$

<p>
<b>a)</b>
Find the analytical solution of the problem.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Integrate the equation separately for \( x < 1 \) and \( x>1 \). Use
the conditions that \( u \) and \( u' \) must be continuous at \( x=1 \).

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Use \( \baspsi_i = \sin((i+1)\frac{\pi x}{2}) \),
\( i=0,\ldots,N \) and the Galerkin method to find an approximate
solution \( u=\sum_j c_j\baspsi_j \).
Plot how fast the coefficients \( c_j \) tend to zero (on a log scale).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Solve the problem with P1 finite elements.
Plot the solution for \( N_e=2,4,8 \) elements.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>cable_discont_load</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:1D:mesh:nonuniform">Exercise 8: Compute with a non-uniform mesh</h2>

<p>
<b>a)</b>
Derive the linear system for the problem \( -u''=2 \) on \( [0,1] \), with
\( u(0)=0 \) and \( u(1)=1 \), using P1 elements and a <em>non-uniform</em> mesh. The
vertices have coordinates \( \xno{0}=0 < \xno{1} < \cdots < 
\xno{N_n-1}=1 \), and the length of cell number \( e \) is \( h_e = \xno{e+1}
-\xno{e} \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
It is of interest to compare the discrete equations for the finite
element method in a non-uniform mesh with the corresponding discrete
equations arising from a finite difference method. Go through the
derivation of the finite difference formula \( u''(x_i) \approx [D_x D_x
u]_i \) and modify it to find a natural discretization of \( u''(x_i) \) on
a non-uniform mesh. Compare the finite element and difference
discretizations

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>nonuniform_P1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:1D:gen:problem1">Problem 9: Solve a 1D finite element problem by hand</h2>

<p>
The following scaled 1D problem is a very simple, yet relevant, model
for convective transport in fluids:

$$
\begin{equation}
u' = \epsilon u'' ,\quad u(0)=0,\ u(1)=1,\ x\in [0,1]
\tp
\tag{96}
\end{equation}
$$

<p>
<b>a)</b>
Find the analytical solution to this problem.
(Introduce \( w=u' \), solve the first-order differential equation for \( w(x) \),
and integrate once more.)

<p>
<b>b)</b>
Derive the variational form of this problem.

<p>
<b>c)</b>
Introduce a finite element mesh with uniform partitioning.
Use P1 elements and compute the element matrix and vector for
a general element.

<p>
<b>d)</b>
Incorporate the boundary conditions and
assemble the element contributions.

<p>
<b>e)</b>
Identify the resulting linear system as a finite difference discretization
of the differential equation using

$$ [D_{2x}u = \epsilon D_xD_x u]_i \tp  $$

<p>
<b>f)</b>
Compute the numerical solution and plot it together with the exact solution
for a mesh with 20 elements and
\( \epsilon=10, 1, 0.1, 0.01 \).

<p>
Filename: <code>convdiff1D_P1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:1D:exact_numerics">Exercise 10: Investigate exact finite element solutions</h2>

<p>
Consider

$$ -u''(x)=x^m,\quad x\in (0,L),\quad u'(0)=C,\ u(L)=D,$$

where \( m\geq 0 \) is an integer, and \( L \), \( C \), and \( D \) are given numbers.
Utilize a mesh with two (non-uniform) elements: \( \Omega^{(0)}=[0,3] \) and
\( \Omega^{(0)}=[3,4] \).
Plot the exact solution and the finite element solution for
\( d=1,2,3,4 \) and \( m=0, 1, 2, 3, 4 \). Find values of \( d \) and \( m \)
that make the finite element solution exact at the nodes in the mesh.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Use the <code>mesh_uniform</code>, <code>finite_element1D</code>, and <code>u_glob2</code> functions
from the <code>fe1D.py</code> module.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>u_xx_xm_P1to4</code>.

<p>
<!-- Could have shooting method as a project -->
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:1D:Poisson:polar">Exercise 11: Compare finite elements and differences for a radially symmetric Poisson equation</h2>

<p>
We consider the Poisson problem in a disk with radius \( R \) with
Dirichlet conditions at the boundary.
Given that the solution is radially symmetric and hence dependent only on
the radial coordinate (\( r=\sqrt{x^2+y^2} \)), we can reduce the problem
to a 1D Poisson equation

$$
\begin{equation}
-\frac{1}{r}\frac{d}{dr}\left( r\frac{du}{dr}\right) = f(r),\quad r\in (0,R),\ 
u'(0)=0,\ u(R)=U_R
\tp
\tag{97}
\end{equation}
$$

<p>
<b>a)</b>
Derive a variational form of <a href="#mjx-eqn-97">(97)</a>
by integrating over the whole disk, or posed equivalently: use
a weighting function \( 2\pi r v(r) \) and integrate \( r \) from \( 0 \) to \( R \).

<p>
<b>b)</b>
Use a uniform mesh partition with P1 elements and show what the
resulting set of equations becomes. Integrate the matrix entries
exact by hand, but use a Trapezoidal rule to integrate the \( f \) term.

<p>
<b>c)</b>
Explain that an intuitive
finite difference method applied to <a href="#mjx-eqn-97">(97)</a>
gives

$$
\frac{1}{r_i}\frac{1}{h^2}\left( r_{i+\half}(u_{i+1}-u_i) -
r_{i-\half}(u_{i}-u_{i-1})\right) = f_i,\quad i=rh
\tp
$$

<p>
For \( i=0 \) the factor \( 1/r_i \) seemingly becomes problematic. One must always
have \( u'(0)=0 \), because of the radial symmetry, which implies
\( u_{-1}=u_1 \), if we allow introduction of a fictitious value \( u_{-1} \).
Using this \( u_{-1} \) in the difference equation for \( i=0 \) gives

$$
\begin{align*}
&\frac{1}{r_0}\frac{1}{h^2}\left( r_{\half}(u_{1}-u_0) -
r_{-\half}(u_{0}-u_{1})\right) = \\ 
& \qquad
\frac{1}{r_0}\frac{1}{2h^2}\left( (r_0 + r_1)(u_{1}-u_0) -
(r_{-1} + r_0)(u_{0}-u_{1})\right) \approx
2(u_1-u_0),
\end{align*}
$$

if we use \( r_{-1}+r_1\approx 2r_0 \).

<p>
Set up the complete set of equations for the finite difference method
and compare to the finite element method in case a Trapezoidal rule
is used to integrate the \( f \) term in the latter method.

<p>
Filename: <code>radial_Poisson1D_P1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:1D:gen:problem2">Exercise 12: Compute with variable coefficients and P1 elements by hand</h2>

<p>
Consider the problem
$$
\begin{equation}
-\frac{d}{dx}\left( \dfc(x)\frac{du}{dx}\right) + \gamma u = f(x),
\quad x\in\Omega=[0,L],\quad u(0)=\dfc,\ u'(L)=\beta\tp
\tag{98}
\end{equation}
$$

We choose \( \dfc(x)=1+x^2 \). Then
$$
\begin{equation} u(x) = \dfc + \beta(1+L^2)\tan^{-1}(x),
\tag{99}
\end{equation}
$$

is an exact solution if \( f(x) = \gamma u \).

<p>
Derive a variational formulation and compute general expressions for the
element matrix and vector in an arbitrary element, using P1 elements
and a uniform partitioning of \( [0,L] \). The right-hand side
integral is challenging and can be computed by a numerical integration
rule. The Trapezoidal rule \eqref{fem:approx:fe:numint1:trapez}
gives particularly simple expressions.
Filename: <code>atan1D_P1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fem:deq:exer:2D:torsion:xy:sin">Exercise 13: Solve a 2D Poisson equation using polynomials and sines</h2>

<p>
The classical problem of applying a torque to the ends of a rod
can be modeled by a Poisson equation defined in the cross section \( \Omega \):

$$ -\nabla^2 u = 2,\quad (x,y)\in\Omega,$$

with \( u=0 \) on \( \partial\Omega \). Exactly the same problem arises for
the deflection of a membrane with shape \( \Omega \) under a constant load.

<p>
For a circular cross section one can readily
find an analytical solution. For a rectangular cross section the analytical
approach ends up with a sine series. The idea in this exercise is to
use a single basis function to obtain an approximate answer.

<p>
We assume for simplicity that the cross section is the unit square:
\( \Omega = [0,1]\times [0,1] \).

<p>
<b>a)</b>
We consider the basis
\( \baspsi_{p,q}(x,y) = \sin((p+1)\pi x)\sin (q\pi y) \), \( p,q=0,\ldots,n \).
These basis functions fulfill the Dirichlet condition.
Use a Galerkin method and \( n=0 \).

<p>
<b>b)</b>
The basis function involving sine functions are orthogonal.
Use this property in the Galerkin method
to derive the coefficients \( c_{p,q} \) in a
formula \( u=\sum_p\sum_q c_{p,q}\baspsi_{p,q}(x,y) \).

<p>
<b>c)</b>
Another possible basis is
\( \baspsi_i(x,y) = (x(1-x)y(1-y))^{i+1} \), \( i=0,\ldots,N \).
Use the Galerkin method to compute the solution for \( N=0 \).
Which choice of a single basis function is best,
\( u\sim x(1-x)y(1-y) \) or \( u\sim \sin(\pi x)\sin(\pi y) \)?
In order to answer the question,
it is necessary to search the web or the literature for an accurate
estimate of the maximum \( u \) value at \( x=y=1/2 \).

<p>
Filename: <code>torsion_sin_xy</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._varform-solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._varform-solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

